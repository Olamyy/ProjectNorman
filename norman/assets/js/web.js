function clsPage(){var c=this;c.sessionReady;this.init=function(){using("HelperLib");using("DHTMLLib");using("XMLLib");var l=new hl.clsEventHandler();c.attachEvents=l.attachEvent;c.detachEvents=l.detachEvent;c.raiseEvent=l.raiseEvent;hl.attachEvents(window,window,"onscroll",b);setTimeout(j,10)};function j(){c.raiseEvent("sessionready")}function a(){var n=document.getElementsByClassName("addToSlack");for(var m=0;m<n.length;m++){var l=n[m].getAttribute("href");l+=aoc.clientId;n[m].setAttribute("href",l)}}this.genLink=function(l){try{document.getElementById("eventFrame").src=l+".html"}catch(m){}};this.pageReady=function(){a()};this.registerStats=function(l){try{wafstats.register(l,aoc.emailId,aoc.clientId)}catch(m){}};this.trackEvent=function(l,m,n){try{if(n==null){n=0}if(l==null){l="button"}l=l.replace(/ /g,"_");m=m.replace(/ /g,"_");ga("send","event",l,"click",m,n)}catch(o){}};function b(){var l=window.pageYOffset||document.documentElement.scrollTop}var h;this.popup=function(n,r,p){p=p||"Message from appsonchat";var l=document.getElementById("aocMessage");h=r;if(l==null){l=document.body.appendChild(document.createElement("div"));l.id="aocMessage";l.innerHTML="<div class='brand'></div><h3 wftype='hdr'></h3><div class='regularFont descColor dparastart' wftype='msg'></div><div class='buttonctr' ><button class='mainbutton button' id='popupbutton' onclick='page.closePopup()'>Ok</button></div>";l.className="disappear easeTrans popup"}var m=dl.getChildByType(l,"msg");m.innerHTML=n;m=dl.getChildByType(l,"hdr");m.innerHTML=p;dl.removeClass(l,"hide");dl.removeClass(l,"disappear");var q=dl.getScreenCenterPos(window,l.offsetWidth,l.offsetHeight);l.style.left=q.x+"px";var o=window.pageYOffset||document.documentElement.scrollTop;l.style.top=(q.y-o)+"px";document.getElementById("popupbutton").focus();c.showOverlay(c.closePopup)};this.closePopup=function(){g=null;c.hideOverlay();var l=document.getElementById("aocMessage");dl.addClass(l,"disappear");try{h()}catch(n){}setTimeout(m,300);function m(){dl.addClass(l,"hide")}};var g;this.showOverlay=function(m){var l=document.getElementById("overlay");g=m;hl.attachEvents(window,l,"onclick",c.hideOverlay);document.body.style.overflow="hidden";dl.removeClass(document.getElementById("overlay"),"hide")};this.hideOverlay=function(l){document.body.style.overflow="auto";dl.addClass(document.getElementById("overlay"),"hide");if(l!=false){try{g()}catch(m){}}}}var page=new clsPage();page.init();if(window.addEventListener){window.addEventListener("load",page.pageReady,false)}else{if(typeof(window.attachEvent)!="undefined"){window.attachEvent("onload",page.pageReady)}}function clsProvision(){var D=this;this.host="";this.appid="";this.key="";this.email="";this.setUserToPlan=C;this.changePlan=x;this.updatePlanStatus=g;this.activateUser=b;this.deactivateUser=p;this.suspendUser=n;this.setConsumption=c;var F=[];var A;var w;var h;o();function m(G,H){try{var K=G.document.getElementsByTagName("head")[0]||G.documentElement;var I=G.document.createElement("script");I.type="text/javascript";I.async="async";I.src=unescape(H);K.appendChild(I);return I}catch(J){y(H)}}function y(H){try{var K=windowElement.document.getElementsByTagName("head")[0]||windowElement.documentElement;var I=windowElement.document.createElement("script");return m(H)}catch(J){}var G=unescape("%3Cscript type='text/javascript' src='"+H+"'>%3C/script>");document.write(G)}function a(){var G=window.wflib;window.wflib=null;using("helperLib");using("XMLLib");using("DHTMLLib");A=wflib.helperLib;w=wflib.DHTMLLib;h=wflib.XMLLib;window.wflib=G;D.uniqueId=A.getUniqueId();window[D.uniqueId]=D;D.prefix="window."+D.uniqueId+"."}var z=false;function o(){var H;try{H=clshelperLib}catch(G){}if(H==null){if(z!=true){z=true;m(window,window.location.protocol+"//run.wolfframeworks.com/widgets/release/wflib.js")}setTimeout(o,30)}else{a()}}function r(I,K,J,H){F.push(H);K.callbackparam=F.length-1;K.p_email=D.email;var G=v(I,K,J);w.addScript(window,G)}function v(J,L,K){var I=window.location.protocol+"//"+D.host+"/webservices/wf.handlers/javascript.ashx?appid="+D.appid+"&key="+D.key+"&callback="+D.prefix+K+"&service=processbusinessrule&wsf=1&mode=xml&rulename="+J;var H="";for(var G in L){H+="&"+G+"="+L[G]}I+=H;return I}function l(H,G){var I=h.objXMLDocTemplate.cloneNode(true);I.loadXML(H);return I.selectNodes(G)}function q(H){var J={};for(var I=0;I<H.length;I++){var G=H[I];J[h.getNodeText(G,"p")]=parseFloat("0"+h.getNodeText(G,"v"))}return J}function E(H){if(H.length==0){return{dtr:"100"}}var J={};var K=H[0].childNodes;for(var I=0;I<K.length;I++){var G=K[I];J[G.nodeName]=G.text}return J}function C(J,H){var I=D.email;var G=I.toString().split("@")[0];r("Set Plan Status",{p_userid:I,p_name:G,p_plancode:J,p_status:H},"cb_setUserToPlan");this.cb_setUserToPlan=function(K){}}function x(G){r("Change Plan",{p_plancode:G},"cb_changePlan");this.cb_changePlan=function(H){}}function g(G){r("Update Plan Status",{p_status:G},"cb_updatePlanStatus");this.cb_updatePlanStatus=function(H){}}function b(){updatePlanStatus("a")}function p(){updatePlanStatus("d")}function n(){updatePlanStatus("s")}function c(H,G){r("Set Consumption",{p_prop:H,p_value:G},"cb_setConsumption");this.cb_setConsumption=function(I){}}this.getConsumptionAndLimits=function(G){r("Get Limits and Consumption",{},"cb_COLResults",G)};this.cb_COLResults=function(G,I){if(F[parseInt(I)]!=null){var H=q(l(G,"//data//record[t = 'c']"));var J=q(l(G,"//data//record[t = 'l']"));F[parseInt(I)]({consumption:H,limits:J})}};this.getPlanDetails=function(G){r("Get Plan Details",{},"cb_PlanDetails",G)};this.cb_PlanDetails=function(G,H){D.plan=E(l(G,"//PlanDetails//record"));D.consumption=q(l(G,"//data//record[t = 'c']"));D.limits=q(l(G,"//data//record[t = 'l']"));if(F[parseInt(H)]!=null){F[parseInt(H)]({plan:D.plan,consumption:D.consumption,limits:D.limits})}};this.getAllPlansLimits=function(G){r("Get Plans Limits",{},"cb_allPlansLimits",G)};this.cb_allPlansLimits=function(G,I){if(G.length==0){return}var K=[];var J=l(G,"//record");for(var L=0;L<J.length;L++){var H=J[L];var M={};M.plancode=h.getNodeText(H,"plancode");M.plantitle=h.getNodeText(H,"plantitle");M.property=h.getNodeText(H,"p");M.value=parseFloat("0"+h.getNodeText(H,"v"));K[L]=M}if(F[parseInt(I)]!=null){F[parseInt(I)](K)}};this.getUserConsumptionList=function(G){r("Get Plan Details",{},"cb_getUserConsumptionList",G)};this.cb_getUserConsumptionList=function(G,I){if(G.length==0){return}var L=[];var J=l(G,"//data//record[t = 'c']");for(var K=0;K<J.length;K++){var H=J[K];var M={};M.property=h.getNodeText(H,"p");M.value=parseFloat("0"+h.getNodeText(H,"v"));L[K]=M}if(F[parseInt(I)]!=null){F[parseInt(I)](L)}};var j,B,u={};this.getDowngradePlans=function(H){D.getAllPlansLimits(G);function G(I){B=I;u.planLimits=B;D.getUserConsumptionList(J);function J(K){j=K;u.planConsumption=j;H(u)}}};this.UpdateUserPlanFieldValues=function(H,G){r("Update UserPlan Field Values",{p_field:H,p_value:G},"cb_updateFieldValues");this.cb_updateFieldValues=function(I){}};this.getSubscriptionProfileId=function(G){r("Fetch Subscription Profile ID",{},"cb_getSubscriptionProfileId",G)};this.cb_getSubscriptionProfileId=function(G,H){if(G.length==0){return}var I={};I.itemname=h.getNodeText(G,"//itemName");I.itemnumber=h.getNodeText(G,"//itemNumber");I.payeremail=h.getNodeText(G,"//payerEmail");I.useremail=h.getNodeText(G,"//userEmail");I.profileid=h.getNodeText(G,"//profileId");if(F[parseInt(H)]!=null){F[parseInt(H)](I)}}}var provision=new clsProvision();var app=function(){var m=this;this.register=o;this.add=b;this.aoc_uid;this.aoc_appId;this.aoc_commonDesc;this.aoc_name;this.aoc_appUrl;this.cb_appId;this.cb_boxId;this.cb_boxName;this.appId="";this.clientId="";this.AOCAppInstanceId="";this.appType="";this.slackToken="";this.init=l;var g="token=30310bf1-9068-4269-9912-84ded384bb14";var n=window.location.href.indexOf("local")>=0?"local.collatebox.com":"web.collatebox.com";var h="http://"+n+"/webservices/aoc.ashx";var a=h+"?"+g;var j={};function l(q,r){m.aoc_appId=q;hl.processRequestAsync(a,null,{command:"apps.appDef",aocappId:q},null,p);function p(u){u=hl.arrayResponseToJSON(u);var u=u.data.document.record;if(u!=null){m.aoc_appUrl=u.AppUrl;m.aoc_appId=u.a;m.cb_boxName=u.f;m.cb_appId=u.e;m.aoc_commonDesc=u.h;m.support=u.i;m.aoc_name=u.g;m.aoc_uid=u.u;try{r()}catch(v){}}}}function o(p,q,r){j.create=r;m.commToken=q;m.slackToken=q;m.clientId=p;m.commApp="Slack";hl.processRequestAsync(a,null,{command:"apps.create",clientId:p,aocappId:m.aoc_appId,appToken:q},null,c)}function c(p){p=hl.arrayResponseToJSON(p);m.AOCAppInstanceId=p.r_uniqueid;try{j.create()}catch(q){delete j.create}}function b(p,q){j.add=q;hl.processRequestAsync(a,null,{command:"apps.addRow",clientId:m.clientId,appId:m.aoc_appId,row:p},null,j.add)}};var pollingApp=new app();pollingApp.appId="ollan_41639";function clsAOC(){var r=this;this.isSessionActive=v;this.signOut=c;this.signIn=o;this.clientToken="30310bf1-9068-4269-9912-84ded384bb14";this.registerUser=n;this.getUserCreds=a;this.loadPublicApps=h;this.clientId=p("AOCClientId",true);this.emailId="";this.apps={};this.user=new clsUser();this.inSession=null;var g;var l="token="+r.clientToken;var w=window.location.href.indexOf("local")>=0?"local.collatebox.com":"web.collatebox.com";var m="http://"+w+"/webservices/aoc.ashx";var b=m+"?"+l;function h(y){hl.processRequestAsync(b,null,{command:"aoc.user.registeredApps",clientId:"public"},null,x);function x(B){var F=xl.objXMLDocTemplate.cloneNode(true);F.loadXML(B);var A=F.selectNodes("//data/document/record");for(var C=0;C<A.length;C++){var D=A[C];var z=new app();z.aoc_name=xl.getNodeText(D,"g");z.aoc_commonDesc=xl.getNodeText(D,"h");z.aoc_appId=xl.getNodeText(D,"a");z.aoc_uid=xl.getNodeText(D,"u");z.cb_appId=xl.getNodeText(D,"e");z.cb_boxName=xl.getNodeText(D,"f");z.support=xl.getNodeText(D,"i");r.apps[z.aoc_name.toLowerCase()]=z}try{y()}catch(E){}}}function n(x,y,z){this.emailId=x;hl.processRequestAsync(b,null,{command:"aoc.registerUser",params:{p_clientid:r.clientId,p_password:y,p_emailid:x}},null,z)}function a(x,z,y,A){hl.processRequestAsync(b,null,{command:"aoc.getAppCreds",params:{p_clientid:x,p_appid:z,p_emailid:y}},null,A)}function c(){r.clientId=p("AOCClientId",true,true);r.user=new clsUser();r.user.clientId=r.clientId}var q={};function j(){var x=hl.deserialiseQueryString(window.location.href);if(x.aocsessionid!=null){u("AOCClientId",x.aocsessionid)}}function v(z){j();r.clientId=p("AOCClientId",true);if(g==true){try{z(false)}catch(y){}return}r.user=new clsUser();r.user.init(r.clientId,r.clientToken,x);function x(){r.inSession=false;if(!hl.isNullOrEmpty(r.user.clientUserToken)){g=false;r.emailId=r.user.emailId;r.inSession=true}try{z()}catch(A){}}}function o(x,y,A){r.user=new clsUser();r.user.signIn(x,y,z);function z(){r.inSession=false;if(!hl.isNullOrEmpty(r.user.clientUserToken)){g=false;u("AOCClientId",r.user.clientId);r.emailId=r.user.emailId;r.inSession=true}else{g=true}try{A(!g)}catch(B){}}}function u(y,z){var A=new Date();var x=new Date(A.getFullYear(),A.getMonth(),A.getDate()+1,A.getHours(),A.getMinutes(),A.getSeconds());document.cookie=y+"=; expires=Thu, 01 Jan 1970 00:00:00 UTC";document.cookie=y+"="+z+"; expires="+x.toUTCString()+"; path=/"}function p(x,z,E){var A=x+"=";var B=document.cookie.split(";");if(E!=true){for(var C=B.length-1;C>=0;C--){var F=B[C];while(F.charAt(0)==" "){F=F.substring(1,F.length)}if(F.indexOf(A)==0){return F.substring(A.length,F.length)}}}if(z==true){var y=new Date();var D=y.valueOf()+""+Math.floor((Math.random()*1000));u(x,D);g=true;return D}return null}}var aoc=new clsAOC();function clsUser(){var n=this;this.clientId;this.emailId;this.clientUserToken;this.clientToken;this.init=m;this.signOut=g;this.signIn=h;this.registerApp=a;this.unregisterApp=o;this.loadRegisteredApps=b;this.apps={};var p=window.location.href.indexOf("local")>=0?"local.collatebox.com":"web.collatebox.com";var c="http://"+p+"/webservices/aoc.ashx";function l(){var q="token="+n.clientToken;var r="usertoken="+n.clientUserToken;return c+"?"+q+"&"+r}function m(q,r,v){n.clientId=q;n.clientToken=r;hl.processRequestAsync(l(),null,{command:"aoc.isUserAuthenticated",params:{p_clientid:q}},null,u);function u(w){w=hl.arrayResponseToJSON(w);if(w.authenticated=="True"){j(w)}try{v()}catch(x){}}}function b(r){hl.processRequestAsync(l(),null,{command:"aoc.user.registeredApps",clientId:n.clientId},null,q);function q(w){var A=xl.objXMLDocTemplate.cloneNode(true);A.loadXML(w);var v=A.selectNodes("//data/document/record");for(var x=0;x<v.length;x++){var y=v[x];var u=new app();u.aoc_name=xl.getNodeText(y,"g");u.aoc_commonDesc=xl.getNodeText(y,"h");u.aoc_appId=xl.getNodeText(y,"a");u.aoc_uid=xl.getNodeText(y,"u");u.cb_appId=xl.getNodeText(y,"e");u.cb_boxName=xl.getNodeText(y,"f");u.support=xl.getNodeText(y,"i");u.commApp=xl.getNodeText(y,"d");u.commToken=xl.getNodeText(y,"c");n.apps[u.aoc_name.toLowerCase()]=u}try{r()}catch(z){}}}function g(){}function j(q){n.clientUserToken=q.clientUserToken||"1";n.emailId=q.emailId;n.clientId=q.clientId||n.clientId}function h(q,r,v){hl.processRequestAsync(l(),null,{command:"aoc.isUserAuthenticated",params:{p_emailid:q,p_password:r}},null,u);function u(w){w=hl.arrayResponseToJSON(w);if(w.authenticated=="True"){j(w)}try{v()}catch(x){}}}function a(v,r,w){var u=new app();u.commToken=r;u.slackToken=r;u.init(v,q);function q(){if(n.apps[u.aoc_name.toLowerCase()]!=null){u=n.apps[u.aoc_name.toLowerCase()]}n.apps[u.aoc_name.toLowerCase()]=u;u.register(n.clientId,r,w)}}function o(q,r){}}var evalText="var cb";try{if(cb){evalText=""}}catch(e){}eval(evalText);var win=window;for(var i=0;i<3;i++){if(win.cb!=null){cb=win.cb;break}try{if(getHost(win.location.host)==getHost(win.parent.location.host)){win=win.parent}}catch(e){break}}function getHost(a){var a=a.split("/")[0].split(".");return a[a.length-2]+"."+a[a.length-1]}var evalText="var utils = {}";try{if(utils){evalText=""}}catch(e){}eval(evalText);utils.deepCopy=function(b,g){var g=g||{};for(var a in b){if(typeof b[a]==="object"&&b[a]!=null){if(b[a].constructor!=null&&b[a].constructor.toString().indexOf("HTML")<0&&b[a].constructor.toString().toLowerCase().indexOf("xmldocument")<0&&b[a].constructor.toString().toLowerCase().indexOf("document")<0){g[a]=(b[a].constructor.toString().indexOf("Array")>=0)?[]:{};utils.deepCopy(b[a],g[a])}else{g[a]=b[a]}}else{g[a]=b[a]}}return g};utils.showVideo=function(b,a){utils.showPopup(b,640,425,null,cb.pages.popups+"/video.html",{video:a})};utils.getPublicQS=function(a){return"bi="+a.box.id+"&va="+a.view.appId+"&vi="+a.view.id};utils.online=function(c,b){if(navigator.onLine==false){return false}var a=hl.deserialiseQueryString(window.location.href);if(b!=false&&!hl.isNullOrEmpty(c)){if(!hl.isNullOrEmpty(c)&&hl.isNullOrEmpty(__getItem(c))){return true}if(hl.isNullOrEmpty(c)){return true}}if(typeof cbWorkMode!="undefined"){if(cbWorkMode=="online"){return true}if(cbWorkMode=="offline"){return false}}if(a.workmode=="offline"){return false}return true};utils.showPopup=function(h,c,p,q,a,b,l,n){var o="width:"+c+"px;height:"+p+"px;";var j=dl.showCustomDialog(h,o,true,"darktransparency",false,null,null,"/blank.htm");j.coverframeClick=cancelPop;j.args=b;var g="";if(l==true){g="<div wftype='close' style='position:absolute;top:0px;height:30px;background:#2A3542;width:100%;'><span class='popuptc close'><span  class='icons-new popupclose' ></span></span></div>";o="width:"+c+"px;height:"+(p-30)+"px;";j.container.style.paddingTop="30px"}if(n==false){n=""}else{n="card depth3"}j.container.innerHTML=g+"<iframe class='"+n+"' src='"+a+"'  style='"+o+"border:0px' frameborder='0' allowtransparency = 'true'></iframe>";if(l==true){var m=dl.getChildByType(j.container,"close");hl.attachEvents(window,m,"onclick",cancelPop)}j.callBackRef=q;return j};function cancelPop(){var a=dl.getDialog();a.coverframeClick=null;a.close()}utils.checkProfile=function(b){if(hl.isNullOrEmpty(cb.session.name)){utils.changeProfile(b,{message:"Information required to complete your product activation"})}if(cb.provision.plan==null){return}var a=cb.provision.plan.dtr||"0";if(parseInt(a)<0){a=0}if(a==0){utils.subscribe()}};utils.changeProfile=function(c,b){utils.showPopup(c,605,510,a,cb.pages.popups+"/profile.html",b);function a(g){c.document.getElementById("username").innerHTML=cb.getUserHTML(cb.session.name,cb.session.emailId);c.document.getElementById("userimg").src="/data/images/users/small-"+cb.session.emailId+".jpg?"+hl.getUniqueId();if(g!=null&&g.subscribe==true){setTimeout(_forceSubscribe,100)}}};function _forceSubscribe(){utils.subscribe({force:true})}utils.subscribe=function(a){if(a==null){a={}}cb.stats.register("Subscribe");utils.showPopup(window,530,530,b,cb.pages.popups+"/payment.html",a);function b(c){}};utils.loadObjectFields=function(c,g,h){var a="<![CDATA[<document><record><path>$application/objects/release/"+c+"_def.xml</path><xsl>/wsfdesigner/xsl/objectfields.xsl</xsl><params><param>"+g+"</param></params></record></document>]]>";xl.serverTransformXMLAsync(b,a);function b(j){var m=xl.objXMLDocTemplate.cloneNode(true);m.loadXML(j);try{h(m)}catch(l){}}};utils.loadObjectAndViews=function(c){var a='<![CDATA[<document><record><uselocal>yes</uselocal><path id="t">$application/xml/tree.xml</path><path id="view">$application/xml/views.xml</path><path id="cat">$application/tcombos/category.xml</path><xsl>/wsfdesigner/xsl/diysplashdef.xsl</xsl><savepath>$application/xml/cb_splash.xml</savepath></record></document>]]>';xl.serverTransformXMLAsync(b,a);function b(g){g=g.replace(/\$a/g,cb.session.appId);var h=xl.objXMLDocTemplate.cloneNode(true);h.loadXML(g);try{c(h)}catch(j){}}};utils.getFeedback=function(b){utils.showPopup(b,600,500,a,cb.pages.popups+"/feedback.html");function a(){}};utils.buildCommitXml=function(c,h){var a="<record><objectHeader.objectName>"+h+"</objectHeader.objectName>";for(var b=0;b<c.length;b++){col=c[b];if(col.colName=="objectHeader.UniqueID"){a+="<objectHeader.UniqueID>"+col.value+"</objectHeader.UniqueID>"}else{a+="<"+col.colName+">"+g(col.value)+"</"+col.colName+">"}}a+="</record>";return{xml:a};function g(j){j=j!=null?j.toString():"";j=j.replace(/</g,"%3C").replace(/>/g,"%3E");j=j.replace(/&lt;/g,"%3C");j=j.replace(/&gt;/g,"%3E");j=j.replace(/&amp;/g,"%26");j=j.replace(/&nbsp;/g," ");return j}};utils.cbDesignerService=function(c,g,j,b,a,h){h=h||"";__cbService(c,null,g,j,b,a,h+hl.wsfMapPath("/webservices/wolfserviceproxy.asmx"))};utils.cbService=function(c,j,g,l,b,a,h){h=h||"";__cbService(c,j,g,l,b,a,h+hl.wsfMapPath("/webservices/wolfserviceproxy.asmx"))};function __cbService(m,o,c,p,h,n,g){if(hl.isNullOrEmpty(h)){h="ProcessBusinessRule"}if(n==null){n={}}if(c==null){c={}}var j=n.cacheName;var l=n.cachePriority;delete n.cacheName;delete n.cachePriority;if(!hl.isNullOrEmpty(o)){n.sBusinessRuleName=o;var b="";for(var a in c){if(c[a]!=null){b+="<"+a+">"+c[a]+"</"+a+">"}}if(n.appId==null){n.appId=cb.session.appId}n.sXML="<![CDATA[<document><record>"+b+"</record></document>]]>"}if(utils.online(j)){if(l=="1"&&__getItem(j)!=null){setTimeout(function(){__genericCallbackForCBService(__getItem(j),p,j,"1")},10);hl.processSoapRequestAsync(m,function(q){__genericCallbackForCBService(q,null,j)},g,"",h,n)}else{hl.processSoapRequestAsync(m,function(q){__genericCallbackForCBService(q,p,j)},g,"",h,n)}}else{if(h=="Commit"){__addToCommitCache({service:h,serviceParams:n,serviceLocation:g})}else{setTimeout(function(){__genericCallbackForCBService(null,p,j)},10)}}}utils.flushCommitCache=function(){if(!utils.online()){return}for(var a=0;a<localStorage.length;a++){if(localStorage.key(a).indexOf("commit")==0){cacheName=localStorage.key(a);var b=JSON.parse(__getItem(localStorage.key(a)));hl.processSoapRequestAsync(window,function(c){__genericCallbackForFlush(c,cacheName)},b.serviceLocation,"",b.service,b.serviceParams);break}}};function __genericCallbackForFlush(a,b){__clearItem(b);utils.flushCommitCache()}utils.setItem=__setItem;utils.getItem=__getItem;utils.getItems=__getItems;utils.getPendingCommitsForView=__getPendingCommitsByView;utils.clearItem=__clearItem;utils.clearItemsWithPrefix=__clearItemsWithPrefix;function __clearItemsWithPrefix(b){if(hl.isNullOrEmpty(b)){return}for(var a=localStorage.length-1;a>=0;a--){if(localStorage.key(a).indexOf(b)==0){__clearItem(localStorage.key(a))}}}function __clearItem(a){localStorage.removeItem(a);var a=(cb.session.currentCred||"")+a;localStorage.removeItem(a)}function __getPendingCommitsByView(h){var b=[];for(var c=0;c<localStorage.length;c++){if(localStorage.key(c).indexOf("commit")>=0){var g=__getItem(localStorage.key(c));if(g.indexOf(h)>=0){b[b.length]=__getItem(localStorage.key(c))}}}return b}function __setItem(a,b){if(hl.isNullOrEmpty(a)){return}var a=(cb.session.currentCred||"")+a;if(b.indexOf("System.Net.WebException")>=0){return}try{if(typeof LZString144!="undefined"){localStorage.removeItem(a);a=a+"lz";b=LZString144.compressToUTF16(b)}localStorage.setItem(a,b)}catch(c){}}function __getItems(g){var b=[];var h=(cb.session.currentCred||"")+g;for(var c=0;c<localStorage.length;c++){if(localStorage.key(c).indexOf(g)==0||localStorage.key(c).indexOf(h)==0){b[b.length]=__getItem(localStorage.key(c))}}return b}function __getItem(b){if(hl.isNullOrEmpty(b)){return null}var c=(cb.session.currentCred||"")+b;var a=localStorage.getItem(c);if(hl.isNullOrEmpty(a)){a=localStorage.getItem(b);if(hl.isNullOrEmpty(a)){c=c+"lz";if(typeof LZString144!="undefined"){a=localStorage.getItem(c);if(!hl.isNullOrEmpty(a)){a=LZString144.decompressFromUTF16(a)}}}}return a}function __addToCommitCache(a){__setItem("commit"+hl.getUniqueId(true),JSON.stringify(a))}function __genericCallbackForCBService(b,j,h,g){var a=b;if(!hl.isNullOrEmpty(h)){if(!utils.online(h)||g=="1"){b=__getItem(h);a=xl.objXMLDocTemplate.cloneNode(true);a.loadXML(b.replace(/xmlns=/g,"x="))}else{__setItem(h,a.xml)}}try{j(a)}catch(c){}}utils.setUserProp=function(c,a){cb.session.props[c]=a;var b="<document><record><objectHeader.UniqueID>"+cb.session.reg_uid+"</objectHeader.UniqueID><objectHeader.objectName>Registration</objectHeader.objectName><WFprops>"+JSON.stringify(cb.session.props)+"</WFprops></record></document>";utils.cbService(window,null,null,null,"Commit",{sXML:"<![CDATA["+b+"]]>",appId:"1951dddd_a2030"})};utils.serverTransformXMLAsync=function(h,b,g){if(utils.online(g)||hl.isNullOrEmpty(g)){var a=h;if(!hl.isNullOrEmpty(__getItem(g))){setTimeout(function(){__genericServerTransformXML(null,h,g,true)},10);a=null;setTimeout(c,8000)}else{c()}}else{setTimeout(function(){__genericServerTransformXML(null,h,g)},10)}function c(){xl.serverTransformXMLAsync(function(j){__genericServerTransformXML(j,a,g)},b)}};function __genericServerTransformXML(b,h,g,a){if(!hl.isNullOrEmpty(g)){if(!utils.online(g)||a==true){b=__getItem(g)}else{if(!hl.isNullOrEmpty(b)){__setItem(g,b)}}}try{h(b)}catch(c){}}utils.wsService=function(q,h,r,l,c,m,o,g){if(hl.isNullOrEmpty(m)){m="processbusinessrule"}var a="&service="+m;if(o=="guest"){a+="&key=2030"}if(!hl.isNullOrEmpty(h)){a+="&rulename="+h}if(!hl.isNullOrEmpty(l)){a+="&mode="+l}var n,j,p;if(c!=null){n=c.cacheName;j=c.callbackparam;p=c.cachePriority;delete c.cachePriority;for(var b in c){if(b=="cacheName"||b=="callbackparam"){continue}a+="&"+b+"="+escape(escape(c[b]))}}var j=r+"~"+(n||"")+"~"+(j||"");var u=a;if(!hl.isNullOrEmpty(r)){a+="&callback=__genericCallback";u=a;a+="&callbackparam="+j;u+="&callbackparam=~"+n+"~"+j}paramWindows[j]=q;if(utils.online(n)){if(p=="1"&&!hl.isNullOrEmpty(__getItem(n))&&typeof n!="undefined"){setTimeout(function(){__genericCallback(__getItem(n),j)},10);utils.workspaceScript(window,u)}else{utils.workspaceScript(window,a)}}else{if(!hl.isNullOrEmpty(n)){setTimeout(function(){__genericCallback(null,j)},10)}}};var paramWindows={};function __genericCallback(returnValue,param){var w_handle=paramWindows[param]||window;delete paramWindows[param];param=param.split("~");if(!hl.isNullOrEmpty(param[1])){if(!utils.online()&&hl.isNullOrEmpty(returnValue)){returnValue=__getItem(param[1])}else{__setItem(param[1],returnValue)}}try{eval("w_handle."+param[0]+"(returnValue,'"+param[2]+"')")}catch(e){}}utils.workspaceScript=function(a,c){var b=wolf.loginServices.hostURL+"/webservices/wf.handlers/javascript.ashx?appid=1951dddd_a2030&wfs=1&"+c;dl.addScript(a,b)};utils.getPublicHostName=function(){return"http://app.collatebox.com/a";return"http://"+window.location.host.split(".")[0]+"open.collatebox.com"};utils.registerHovers=function(l){var h=l.document.getElementsByClassName("fnHover");var m=l.document.getElementsByClassName("fnDown");for(var j=0;j<h.length;j++){var a=h[j];if(a.getAttribute("hoverattached")=="true"){continue}hl.attachEvents(l,a,"onmouseover",b);hl.attachEvents(l,a,"onmouseout",g);a.setAttribute("hoverattached","true")}for(var j=0;j<m.length;j++){var a=m[j];if(a.getAttribute("downattached")=="true"){continue}hl.attachEvents(l,a,"onmousedown",n);hl.attachEvents(l,a,"onmouseout",c);hl.attachEvents(l,a,"onmouseup",c);a.setAttribute("downattached","true")}function n(o){a=dl.getEventSrcElement(o);var p=a.getAttribute("downclass");dl.addClass(a,p);a=dl.getParentByClass(a.parentNode,"fnDown");if(a==null){return}p=a.getAttribute("downclass");dl.addClass(a,p)}function c(o){a=dl.getEventSrcElement(o);var p=a.getAttribute("downclass");dl.removeClass(a,p);a=dl.getParentByClass(a.parentNode,"fnDown");if(a==null){return}p=a.getAttribute("downclass");dl.removeClass(a,p)}function b(o){a=dl.getEventSrcElement(o);var p=a.getAttribute("hoverclass");dl.addClass(a,p);a=dl.getParentByClass(a.parentNode,"fnHover");if(a==null){return}p=a.getAttribute("hoverclass");dl.addClass(a,p)}function g(o){a=dl.getEventSrcElement(o);var p=a.getAttribute("hoverclass");dl.removeClass(a,p);a=dl.getParentByClass(a.parentNode,"fnHover");if(a==null){return}p=a.getAttribute("hoverclass");dl.removeClass(a,p)}};utils.registerScrollBars=function(win){var els=win.document.getElementsByClassName("fnScroll");for(var i=0;i<els.length;i++){var el=els[i];if(el.getAttribute("scrollattached")=="true"){continue}hl.attachEvents(win,el,"onmousedown",__scroll);el.setAttribute("scrollattached","true")}function beginScroll(el){var me=this;hl.attachEvents(win,el,"onmouseup",__stop);var settings=el.getAttribute("scrollsettings");settings=eval("({"+settings.replace(/:/g,":'").replace(/;/g,"',")+"'})");var scrollElement=win.document.getElementById(settings.element);var interval=setInterval(__scrollme,10);function __scrollme(){if(scrollElement!=null){switch(settings.direction){case"up":scrollElement.parentNode.scrollTop+=8;break;case"down":scrollElement.parentNode.scrollTop-=8;break}}}function __stop(evt){clearInterval(interval)}}function __scroll(evt){el=dl.getEventSrcElement(evt);new beginScroll(el)}};utils.initTheme=function(b){var a=hl.deserialiseQueryString(b.location.href);utils.setTheme(b,a.theme,true)};utils.currentThemeIndex;utils.setTheme=function(c,a,b){if(a==null){a=0}if(a!=utils.currentThemeIndex||b==true){utils.removeTheme(c);utils.currentThemeIndex=a;utils.applyTheme(c)}};utils.removeTheme=function(b){if(utils.currentThemeIndex==null){return}var a=themes[utils.currentThemeIndex];dl.removeStyleSheet(a.color,b)};utils.applyTheme=function(b){var a=themes[utils.currentThemeIndex];dl.addStyleSheet(a.color,b)};var themes=new Array();themes[0]={back:"/styles/cloud.css",color:"/common/styles/darkonlight.css"};themes[1]={back:"/styles/lawn.css",color:"/common/styles/darkonlight.css"};themes[2]={back:"/styles/christmas.css",color:"/common/styles/lightondark.css"};utils.updateLoadXMLs=function(){var a='<![CDATA[<document><record><path id="t">$application/xml/tree.xml</path><path id="view">$application/xml/views.xml</path><xsl>/wsfdesigner/xsl/diysplashdef.xsl</xsl><savepath>$application/xml/cb_splash.xml</savepath><returnxml>no</returnxml></record></document>]]>';xl.serverTransformXMLAsync(null,a)};utils.cb_serverTransformXMLAsync=function(c){var a;a=hl.processSoapRequestAsync(top,b,hl.mapPath("/webservices/wolfserviceproxy.asmx"),"","XmlTransform","sXML",c,"ApplicationId",cb.session.appId);function b(g){var j="";if(g!=null){j=libraries.XMLLib.getNodeText(g,"//XmlTransformResult")}try{j}catch(h){}}};utils.xmlSort=function(b,g,h){if(g==null){g="/document/record"}sortParentXpathStartElements=g.split("/");var j="",a="";for(var c=0;c<sortParentXpathStartElements.length-1;c++){if(!hl.isNullOrEmpty(sortParentXpathStartElements[c])){j+="<"+sortParentXpathStartElements[c]+">";a="</"+sortParentXpathStartElements[c]+">"+a}}return xl.transformXML(b,'<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform" version="1.0"><xsl:output method="xml" omit-xml-declaration="yes" /><xsl:template match="/">'+j+'<xsl:for-each select="'+g+'"><xsl:sort select="'+h+'"/><xsl:copy-of select="."/></xsl:for-each>'+a+"</xsl:template></xsl:stylesheet>")};var evalText="var wolf = {}";try{if(wolf){evalText=""}}catch(e){}eval(evalText);try{if(top.context!=null){top.cache=top.context.cache;wolf.cache={}}else{top.cache={};wolf.cache={}}}catch(e){}var wflib,hl,dl,xl;function setwflib(){var a=window;for(var b=0;b<5;b++){if(a.helperLib!=null){break}try{if(getHost(a.location.host)==getHost(a.parent.location.host)){a=a.parent}}catch(c){break}}if(a.helperLib!=null){wflib=a}try{hl=wflib.helperLib;dl=wflib.DHTMLLib;xl=wflib.XMLLib}catch(c){}}function getHost(a){var a=a.split("/")[0].split(".");return a[a.length-2]+"."+a[a.length-1]}setwflib();function using(sLibraryName,libraryWindow){var objTemp;if(wflib!=null){libraryWindow=wflib;library=eval("libraryWindow."+sLibraryName)}else{if(libraryWindow==null){libraryWindow=window;for(var i=0;i<5;i++){if(libraryWindow.clshelperLib!=null){break}libraryWindow=libraryWindow.parent}}var library;wflib=libraryWindow;syncLibraries();for(var i=0;i<5;i++){try{library=eval("libraryWindow."+sLibraryName);if(library!=null){wflib=libraryWindow;break}else{if(eval("libraryWindow.cls"+sLibraryName+"(wflib)")!=null){wflib=libraryWindow}libraryWindow=libraryWindow.parent}}catch(e){wflib=window;break}}}if(!library){if(!wflib.libraryDef){wflib.libraryDef=new Array()}if(!wflib.libraryDef[sLibraryName]){try{wflib.libraryDef[sLibraryName]=eval("wflib.cls"+sLibraryName+".toString()")}catch(e){}}try{eval("wflib."+sLibraryName+" = new wflib.cls"+sLibraryName+"(wflib)")}catch(e){try{eval("wflib."+sLibraryName+" = new cls"+sLibraryName+"(wflib)")}catch(e){}}}hl=wflib.helperLib;dl=wflib.DHTMLLib;xl=wflib.XMLLib}function syncLibraries(){try{if(top.libraryDef){wflib.libraryDef=top.libraryDef}return;var dialogArguments=window.dialogArguments;if(dialogArguments==null){if(top.opener.dialog){dialogArguments=top.opener.dialog.arguments}}var openerWindowTop=dialogArguments;var workflowContext=dialogArguments;top.libraryDef=openerWindowTop.libraryDef;if(!top.libraryDef){top.libraryDef=workflowContext.adam.libraryDef}if(!top.libraryDef){return}for(var x in top.libraryDef){eval("top.cls"+x.toString()+" = "+top.libraryDef[x.toString()])}}catch(e){}}try{if(ctr==null){ctr=0}}catch(e){ctr=0}ctr++;if(ctr==1){loadPrototypes()}function loadPrototypes(){if(navigator.userAgent.indexOf("MSIE")>=0){return}if(navigator.userAgent.indexOf("rv:11")>=0){return}if(Document.prototype.loadedPT==true){return}Document.prototype.loadedPT=true;if(navigator.userAgent.indexOf("Safari")>0){HTMLElement.prototype.__setAttribute=HTMLElement.prototype.setAttribute;HTMLElement.prototype.setAttribute=function(attrName,newVal){var prevVal=this.getAttribute(attrName);this.__setAttribute(attrName,newVal);newVal=this.getAttribute(attrName);if(newVal!=prevVal){var evt=document.createEvent("MutationEvent");evt.initMutationEvent("DOMAttrModified",true,false,this,prevVal||"",newVal||"",attrName,(prevVal==null)?evt.ADDITION:evt.MODIFICATION);this.dispatchEvent(evt)}}}Document.prototype.loadXML=function(strXML){var domParser=new DOMParser();var objDoc=domParser.parseFromString(strXML,"text/xml");_copyDocuments(objDoc,this);updateReadyState(this,4)};Node.prototype.__defineGetter__("xml",_Node_getXML);Document.prototype.readyState="0";try{Document.prototype.onreadystatechange=null}catch(e){}Document.prototype.parseError=0;XMLDocument.prototype.selectSingleNode=_selectSingleNode;XMLDocument.prototype.selectNodes=_selectNodes;XMLDocument.prototype.cloneNodeFunction=XMLDocument.prototype.cloneNode;XMLDocument.prototype.cloneNode=_cloneNode;if(XMLDocument.prototype.load==null){XMLDocument.prototype.load=_load}Element.prototype.__defineGetter__("text",_element_getText);Element.prototype.__defineSetter__("text",_element_setText);Element.prototype.__defineGetter__("xml",_Node_getXML);Element.prototype.selectSingleNode=function(sXpath,XPathResultType,resultValue){if(this.ownerDocument.selectSingleNode){return this.ownerDocument.selectSingleNode(sXpath,this,XPathResultType,resultValue)}};Element.prototype.insertAdjacentElement=function(where,parsedNode){switch(where.toLowerCase()){case"beforebegin":this.parentNode.insertBefore(parsedNode,this);break;case"afterbegin":this.insertBefore(parsedNode,this.firstChild);break;case"beforeend":this.appendChild(parsedNode);break;case"afterend":if(this.nextSibling){this.parentNode.insertBefore(parsedNode,this.nextSibling)}else{this.parentNode.appendChild(parsedNode)}break}};Element.prototype.insertAdjacentHTML=function(where,htmlStr){var o=document.createElement("div");o.innerHTML=htmlStr;this.insertAdjacentElement(where,o.firstChild)};Element.prototype.selectNodes=function(sXpath){if(this.ownerDocument.selectNodes){return this.ownerDocument.selectNodes(sXpath,this)}};function _copyDocuments(sourceDoc,targetDoc){while(targetDoc.hasChildNodes()){targetDoc.removeChild(targetDoc.lastChild)}for(var i=0;i<sourceDoc.childNodes.length;i++){var objImportedNode=targetDoc.importNode(sourceDoc.childNodes[i],true);var df=targetDoc.createDocumentFragment();df.appendChild(objImportedNode);targetDoc.appendChild(df)}}function _load(url){var xmlDoc=this;var req=new XMLHttpRequest();if(xmlDoc.onreadystatechange||xmlDoc.onload){req.onreadystatechange=_loadReady}req.open("GET",url,false);req.send("");if(!(xmlDoc.onreadystatechange||xmlDoc.onload)){_copyDocuments(req.responseXML,xmlDoc)}function _loadReady(){if(req.readyState==4){if(req.responseXML.selectSingleNode("/parsererror")!=null){xmlDoc.parseError=9886120856}else{xmlDoc.loadXML(req.responseXML.xml)}}}}function _Node_getXML(){var objXMLSerializer=new XMLSerializer();var strXML=objXMLSerializer.serializeToString(this);return strXML}function _element_getText(){return this.textContent}function _element_setText(value){this.textContent=value}function _selectSingleNode(sXPath,xmlDocument,XPathResultType,resultValue){if(!xmlDocument){xmlDocument=this}if(!XPathResultType){XPathResultType=XPathResult.FIRST_ORDERED_NODE_TYPE}if(!resultValue){resultValue="singleNodeValue"}var oEvaluator=new XPathEvaluator();var oResult=oEvaluator.evaluate(sXPath,xmlDocument,nsResolver,XPathResultType,null);if(oResult!=null){return eval("oResult."+resultValue)}else{return null}}function _selectNodes(xPath,xmlDocument){if(!xmlDocument){xmlDocument=this}var oEvaluator=new XPathEvaluator();var oResult=oEvaluator.evaluate(xPath,xmlDocument,nsResolver,XPathResult.ORDERED_NODE_ITERATOR_TYPE,null);var aNodes=new Array();if(oResult!=null){var oElement=oResult.iterateNext();while(oElement){aNodes.push(oElement);oElement=oResult.iterateNext()}}return aNodes}function _cloneNode(value){var XmlDom=this.cloneNodeFunction(value);if(XmlDom==null){XmlDom=document.implementation.createDocument("","",null)}XmlDom.addEventListener("load",_Document_onload,false);return XmlDom}function nsResolver(sPrefix){switch(sPrefix){case"soap":return"http://schemas.xmlsoap.org/soap/envelope/";case"xsi":return"http://www.w3.org/2001/XMLSchema-instance";case"xsd":return"http://www.w3.org/2001/XMLSchema";case"xsl":return"http://www.w3.org/1999/XSL/Transform";case"transformiix":return"http://www.mozilla.org/TransforMiix"}return null}function _Document_onload(){handleOnLoad(this)}function handleOnLoad(xmlDomDoc){if(!xmlDomDoc.documentElement||xmlDomDoc.documentElement.tagName=="parsererror"){xmlDomDoc.parseError=9886120856}updateReadyState(xmlDomDoc,4)}function updateReadyState(xmlDomDoc,readyState){if(xmlDomDoc.onreadystatechange!=null&&typeof(xmlDomDoc.onreadystatechange)=="function"){xmlDomDoc.readyState=readyState;xmlDomDoc.onreadystatechange()}if(xmlDomDoc.onload!=null&&typeof(xmlDomDoc.onload)=="function"){xmlDomDoc.onload()}}}function clsXMLLib(y){var A=this;var z=y;if(z==null){z=top}using("helperLib",z);this.serverTransformXML=p;this.serverTransformXMLAsync=m;this.transformXML=o;this.getNodeText=l;this.getNodeXML=w;this.setNodeText=r;this.setNodeXML=h;this.getNodeNextSibling=v;this.getNodeFirstChild=a;this.getNodePreviousSibling=j;this.loadXml=x;this.loadXSL=c;var n,g;var q="Msxml2.XSLTemplate.6.0";u();this.objXMLDocTemplate=n;this.objXSLDocTemplate=g;function x(H,D,B){var C;try{C=top.context.cache}catch(G){}var F;try{F=C[D.toString()]}catch(G){}if(F!=null){return B(F,D)}F=wflib.XMLLib.objXMLDocTemplate.cloneNode(true);F.async=true;if(navigator.userAgent.indexOf("MSIE")<0&&navigator.userAgent.indexOf("rv:11")<0){F.onload=I}else{F.onreadystatechange=E}F.load(H);if(D!=null){try{C[D]=F}catch(G){}}function I(){try{B(F,D)}catch(J){}}function E(){if(F.readyState!=4){return}try{B(F,D)}catch(J){}}}function u(){var F;if(navigator.userAgent.indexOf("MSIE")<0&&navigator.userAgent.indexOf("rv:11")<0){F=document.implementation.createDocument("","",null);g=F}else{var E=["MSXML2.DomDocument.6.0","Msxml2.DOMDocument.3.0"];var C=["Msxml2.FreeThreadedDOMDocument.6.0","Msxml2.FreeThreadedDOMDocument.3.0","Msxml2.FreeThreadedDOMDocument.4.0","Msxml2.FreeThreadedDOMDocument.5.0","Msxml2.FreeThreadedDOMDocument","Microsoft.FreeThreadedDOMDocument"];var B=["MSXML2.XSLTemplate.6.0","MSXML2.XSLTemplate.3.0","MSXML2.XSLTemplate.4.0","MSXML2.XSLTemplate.5.0","MSXML2.XSLTemplate","Microsoft.XSLTemplate"];for(var D=0;D<E.length;D++){try{F=new ActiveXObject(E[D]);g=new ActiveXObject(C[D]);q=B[D];break}catch(G){}}}n=F}function r(F,B,G){try{var D;if(typeof(F)=="string"){D=n.cloneNode(true);D.loadXML(F)}else{D=F}var C=D.selectSingleNode(B);if(C==null){C=D.appendChild(D.ownerDocument.createElement(B))}C.text=G;if(typeof(F)=="string"){return D.xml}else{return D}}catch(E){}}function h(D,E,F,B){try{var J;if(typeof(D)=="string"){J=n.cloneNode(true);J.loadXML(D)}else{J=D}var C=J.ownerDocument.cloneNode(true);C.loadXML("<root>"+F+"</root>");var H=J.selectSingleNode(E);if(H!=null){if(B!=true){var K=H.childNodes;for(var G=0;G<K.length;G++){H.removeChild(K[G])}}}else{H=J.appendChild(J.ownerDocument.createElement(E))}H.appendChild(C.selectSingleNode("/root").childNodes[0].cloneNode(true));if(typeof(D)=="string"){return J.xml}else{return J}}catch(I){}}function c(B,C,F){var E;if(z.cache==null){if(z.context==null){z.cache={}}else{z.cache=z.context.cache}}try{E=z.cache[C]}catch(D){}if(E==null){if(!(navigator.userAgent.indexOf("MSIE")<0&&navigator.userAgent.indexOf("rv:11")<0)){E=g.cloneNode(true);E.async=false;try{E.setProperty("AllowXsltScript",true);E.setProperty("AllowDocumentFunction",true)}catch(D){}}else{E=n.cloneNode(true);E.async=false}if(F==true||B.length>100){E.loadXML(B)}else{E.load(B)}}if(C!=null){z.cache[C]=E}return E}function a(B){try{var D=B.childNodes[0];while(D!=null&&D.nodeType==3){D=D.nextSibling}return D}catch(C){return null}}function v(B){try{var D=B.nextSibling;while(D!=null&&D.nodeType==3){D=D.nextSibling}return D}catch(C){return null}}function j(B){try{var D=B.previousSibling;while(D!=null&&D.nodeType==3){D=D.previousSibling}return D}catch(C){return null}}function l(F,E){try{var C,B;if(typeof(F)=="string"){C=n.cloneNode(true);C.loadXML(F)}else{C=F}try{C.setProperty("SelectionNamespaces",'xmlns="http://wolf.co.in/webservices" xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" ')}catch(D){}B=C.selectSingleNode(E);if(B==null){return""}else{if(B.text==undefined){return B.value}return B.text}}catch(D){return""}}function w(F,E){try{var C,B;if(typeof(F)=="string"){C=n.cloneNode(true);C.loadXML(F)}else{C=F}B=C.selectSingleNode(E);if(B==null){return""}else{return B.xml}}catch(D){}}this.webServices={utilityProcessor:{location:"/webservices/wf.object/utilityprocessor.asmx",soapAction:"wf.object"}};function m(G,E,F,C){var B;if(F==true){E="<![CDATA[<document><record><path>"+z.helperLib.wsfMapPath("$application/participant/xml/tree.xml")+"</path><xsl>"+C+"</xsl></record></document>]]>"}B=z.helperLib.processSoapRequestAsync(top,D,z.helperLib.wsfMapPath(A.webServices.utilityProcessor.location),A.webServices.utilityProcessor.soapAction,"XmlTransform","sXML",E);function D(H){var J="";if(H!=null){J=z.XMLLib.getNodeText(H,"//XmlTransformResult")}try{G(J)}catch(I){}}}function p(D,E,C){var B;if(E==true){D="<![CDATA[<document><record><path>"+z.helperLib.wsfMapPath("$applicationid/participant/xml/tree.xml")+"</path><xsl>"+C+"</xsl></record></document>]]>"}B=z.helperLib.processSoapRequest(top,z.helperLib.wsfMapPath(A.webServices.utilityProcessor.location),A.webServices.utilityProcessor.soapAction,"XmlTransform","sXML",D);if(B!=null){return z.XMLLib.getNodeText(B,"//XmlTransformResult")}else{return""}}function b(B){var D,C;if(navigator.userAgent.indexOf("MSIE")<0&&navigator.userAgent.indexOf("rv:11")<0){C=new XSLTProcessor();C.importStylesheet(B)}else{try{D=new ActiveXObject(q);D.stylesheet=B;C=D.createProcessor()}catch(E){alert("error in xmllib.getXSLTProcessor:"+E.description)}}return C}function o(B,K){var C,H,J,D,G;if(typeof(K)=="string"){H=c(K,null,false)}else{H=K}J=n.cloneNode(true);J.async=false;J.loadXML(B);D=b(H,J);if(navigator.userAgent.indexOf("MSIE")<0&&navigator.userAgent.indexOf("rv:11")<0){if(arguments.length>2){for(var E=2;E<arguments.length;E++){D.setParameter(null,"param"+(E-1),arguments[E])}}var F=D.transformToDocument(J);G=F.xml;if(H.xml.indexOf('method="text"')>0&&F.documentElement.textContent){G=F.documentElement.textContent}if(G.indexOf("transformiix:result")>=0){var I=w(G,"//transformiix:result/*[name() != 'transformiix:result']");if(I.length==0){I=l(G,"//transformiix:result")}G=I}}else{D.input=J;if(arguments.length>2){for(var E=2;E<arguments.length;E++){D.addParameter("param"+(E-1),arguments[E])}}D.transform();G=D.output}return(G)}}function clsDHTMLLib(objTop){var me=this;var topWindow=objTop;topWindow.dialogCover=new Array();if(topWindow==null){topWindow=top}this.getEvent=_getEvent;this.getEventSrcElement=function(e){element=e.srcElement?e.srcElement:e.target;return element};this.preventDefault=function(e){(e.preventDefault)?e.preventDefault():e.returnValue=false};this.cancelBubble=function(e){(e.stopPropagation)?e.stopPropagation():e.cancelBubble=true};this.getKeyCode=function(e){return((e.charCode||e.charCode==0)?e.charCode:e.keyCode)};this.leftClicked=_leftClicked;this.getDialog=_getDialog;this.setModifierKeys=_setModifierKeys;this.rememberClicks=_rememberClicks;this.rememberClickHandler=_rememberClickHandler;this.disableSelection=_disableSelection;this.enableSelection=_enableSelection;this.getChildByType=_getChildByType;this.getChildByClass=_getChildByClass;this.getParentByClass=_getParentByClass;this.getParentByType=_getParentByType;this.getWindowPos=getWindowPos;this.getMousePos=getMousePos;this.getScreenCenterPos=_getScreenCenterPos;this.deserialiseDimensions=_deserialiseDimensions;this.getWindowDimensions=_getWindowDimensions;this.getDocumentHeight=_getDocumentHeight;this.getDocumentWidth=_getDocumentWidth;this.getStyleProp=getStyleProp;this.getNumberStyleProp=getNumberStyleProp;this.addStyleSheet=AddStyleSheet;this.addScript=_addScript;this.crossDomainCall=_crossDomainCall;this.removeStyleSheet=removeStyleSheet;this.addClass=addClass;this.removeClass=removeClass;this.replaceClass=replaceClass;this.bHasClass=bHasClass;this.toggleClass=_toggleClass;this.setWaitDisplay=setWaitDisplay;this.getWindowPane=getWindowPane;this.captureMouse=captureMouse;this.fixPNG=_fixPNG;this.toggleGroup=_toggleGroup;this.setPanelDimensions=_setPanelDimensions;this.transition=_transition;this.slideActions=new _slideActions();this.drag=_clsDrag;this.showCustomDialog=_showCustomDialog;this.createCover=_createCover;this.removeCover=_hideCover;this.toggleDashBoards=toggleDashBoards;this.roundIt=_roundIt;this.applyShadow=_applyShadow;this.refreshShadow=_refreshShadow;this.changeToButon=_changeToButon;var _browserBorders;var mouseButtons={left:false,right:false,lastLeft:false,lastRight:false};var __sbd;function getScrollBarWidth(){if(__sbd!=null){return __sbd}var inner=document.createElement("p");inner.style.cssText="width:100%;height:200px";var outer=document.createElement("div");outer.style.cssText="position:absolute;top:0px;left:0px;visibility:hidden;width:50px;height:50px;overflow:hidden";outer.appendChild(inner);document.body.appendChild(outer);var w1=inner.offsetWidth;outer.style.overflow="scroll";var w2=inner.offsetWidth;if(w1==w2){w2=outer.clientWidth}document.body.removeChild(outer);__sbd=(w1-w2);return __sbd}function _setPanelDimensions(win,availableWidth,availableHeight,checkMargins){if(checkMargins==null){checkMargins=false}if(availableWidth==null){availableWidth=_getDocumentWidth(win)}if(availableHeight==null){availableHeight=_getDocumentHeight(win)}var marginTop=0,marginBottom=0,fnDiff;if(checkMargins){marginTop=parseInt(getStyleProp(win.document.body,"marginTop"));marginBottom=parseInt(getStyleProp(win.document.body,"marginBottom"))}__applyDimension(win,"fnPanel","width",availableWidth,"fnPanelDifference");__applyDimension(win,"fnFullheight","height",availableHeight-marginTop,"fnHeightDifference");__applyDimension(win,"fnParentHeight","minHeight","parentNode.offsetHeight","fnHeightDifference")}function __applyDimension(win,className,property,value,diffAttribute){var els=win.document.getElementsByClassName(className);for(var i=0;i<els.length;i++){var el=els[i];var fnDiff=parseInt(el.getAttribute(diffAttribute)||0);var fnAddScrollWidth=el.getAttribute("fnAddScrollWidth");if(typeof value=="string"){value=eval("el."+value)}if(fnAddScrollWidth=="true"){var sbw=getScrollBarWidth();if(fnDiff<=0){fnDiff-=sbw}else{fnDiff+=sbw}}el.style[property]=(value+fnDiff)+"px"}}function _leftClicked(e){_rememberClickHandler(e);var returnVal=false;returnVal=e.type=="click"?mouseButtons.lastLeft:mouseButtons.left;return returnVal}function _rememberClicks(win){if(win.___rememberedClicks==true){return}hl.attachEvents(win,win.document.body,"onmousedown",_rememberClickHandler);hl.attachEvents(win,win.document.body,"onmouseup",_rememberClickHandler);win.___rememberedClicks=true}function _rememberClickHandler(evt){if(evt.type=="mousedown"){mouseButtons.left=(evt.button==1)||(evt.button==0);mouseButtons.right=(evt.button==2);mouseButtons.lastLeft=mouseButtons.left;mouseButtons.lastRight=mouseButtons.right}else{if(evt.type=="mouseup"){mouseButtons.left=false;mouseButtons.right=false}}}function _setModifierKeys(modifierKeys,evt){var isMac=navigator.platform.toUpperCase().indexOf("MAC")!==-1;var ff=navigator.userAgent.toLowerCase().indexOf("firefox")!=-1;if(modifierKeys.ctrlKey==null){modifierKeys.ctrlKey=false;modifierKeys.shiftKey=false;modifierKeys.altKey=false}if(isMac){if(evt.type=="keydown"||evt.type=="keypress"){if(!ff){if(evt.keyCode==91||evt.keyCode==93){modifierKeys.ctrlKey=true}}else{if(ff){if(evt.keyCode==224){modifierKeys.ctrlKey=true}}}if(evt.keyCode==16){modifierKeys.shiftKey=true}if(evt.keyCode==18){modifierKeys.altKey=true}}else{if(modifierKeys.ctrlKey==true&&(evt.keyCode==91||evt.keyCode==93)){modifierKeys.ctrlKey=false}if(modifierKeys.shiftKey==true&&evt.keyCode==16){modifierKeys.shiftKey=false}if(modifierKeys.altKey==true&&evt.keyCode==18){modifierKeys.altKey=true}}}else{modifierKeys.ctrlKey=evt.ctrlKey;modifierKeys.altKey=evt.altKey;modifierKeys.shiftKey=evt.shiftKey}}var ___toggleElements={};function _toggleGroup(win,el,s){var returnValue;if(typeof(el)=="string"){el=win.document.getElementById(el)}if(s.reset==null){___toggleElements[s.groupName]=null}if(___toggleElements[s.groupName]==null||s.reset==null){___toggleElements[s.groupName]=win.document.getElementById(s.defaultTab)}s.reset=false;returnValue=___toggleElements[s.groupName];removeClass(___toggleElements[s.groupName],s.activeClass);addClass(___toggleElements[s.groupName],s.inactiveClass);___toggleElements[s.groupName]=el;if(el==null){return}addClass(___toggleElements[s.groupName],s.activeClass);removeClass(___toggleElements[s.groupName],s.inactiveClass);return returnValue}function _getBrowserWidthKeywords(){if(_browserBorders==null){var borders={};d=document.body.appendChild(document.createElement("div"));d.style.cssText="border:thin solid white;width:10px;display:inline-block;";borders.thin=(d.offsetWidth-10)/2;d.style.borderWidth="medium";borders.medium=(d.offsetWidth-10)/2;d.style.borderWidth="thick";borders.thick=(d.offsetWidth-10)/2;_browserBorders=borders;document.body.removeChild(d)}return _browserBorders}function _checkBrowserBorders(value){var b=_getBrowserWidthKeywords();if(value.indexOf("px")<0){value=b[value]}return value}function _deserialiseDimensions(el){var paddingLeft=_toInt(getStyleProp(el,"paddingLeft"));var paddingRight=_toInt(getStyleProp(el,"paddingRight"));var paddingTop=_toInt(getStyleProp(el,"paddingTop"));var paddingBottom=_toInt(getStyleProp(el,"paddingBottom"));var borderRight=_toInt(_checkBrowserBorders(getStyleProp(el,"borderRightWidth")));var borderLeft=_toInt(_checkBrowserBorders(getStyleProp(el,"borderLeftWidth")));var borderTop=_toInt(_checkBrowserBorders(getStyleProp(el,"borderTopWidth")));var borderBottom=_toInt(_checkBrowserBorders(getStyleProp(el,"borderBottomWidth")));var boxSizing=getStyleProp(el,"box-sizing");var innerWidth=_toInt(getStyleProp(el,"width"));var innerHeight=_toInt(getStyleProp(el,"height"));if(isNaN(innerWidth)){innerWidth=0}if(isNaN(innerHeight)){innerHeight=0}var outerWidth=innerWidth,outerHeight=innerHeight;var totalVerticalPadding=paddingTop+paddingBottom+borderTop+borderBottom;var totalHorizontalPadding=paddingLeft+paddingRight+borderLeft+borderRight;if(el.offsetWidth>0){outerWidth=el.offsetWidth;innerWidth=el.offsetWidth-totalHorizontalPadding}if(el.offsetHeight>0){innerHeight=el.offsetHeight-totalVerticalPadding;outerHeight=el.offsetHeight}function _toInt(v){return parseInt(v.toString().replace("px",""))}return{paddingLeft:paddingLeft,paddingRight:paddingRight,paddingTop:paddingTop,paddingBottom:paddingBottom,totalVerticalPadding:totalVerticalPadding,totalHorizontalPadding:totalHorizontalPadding,innerWidth:innerWidth,innerHeight:innerHeight,outerWidth:outerWidth,outerHeight:outerHeight,borderRight:borderRight,borderLeft:borderLeft,borderTop:borderTop,borderBottom:borderBottom,boxSizing:boxSizing}}function _enableSelection(target){if(typeof target.onselectstart!="undefined"){target.onselectstart=null}else{if(typeof target.style.MozUserSelect!="undefined"){target.style.MozUserSelect=""}else{target.onmousedown=null}}target.style.cursor="default"}function _disableSelection(target){if(typeof target.onselectstart!="undefined"){target.onselectstart=function(){return false}}else{if(typeof target.style.MozUserSelect!="undefined"){target.style.MozUserSelect="none"}else{target.onmousedown=function(){return false}}}target.style.cursor="default"}function _clsDrag(evt,el,win){var me=this;this.instance={endDrag:null,drag:null,x:evt.clientX,y:evt.clientY,dragStartLeft:el.offsetLeft,"  ":el.offsetTop,el:el,fixedTop:true,fixedLeft:false};if(win==null){win=window}el.style.position="absolute";wflib.helperLib.attachEvents(win,win.document,"onmouseup",_endDrag);this.cancelDrag=function(){hl.detachEvents(win,win.document,"onmouseup",_endDrag);me.instance=null};function _endDrag(evt){var distance=0,to=0,force=false;if(el.offsetLeft<me.instance.dragStartLeft){distance=el.parentNode.offsetWidth-(el.offsetLeft+el.offsetWidth);if(distance>0){to=0}}else{if(el.offsetLeft>me.instance.dragStartLeft){distance=el.offsetLeft;if(distance>0){to=0}force=true}else{me.instance.dragStartLeft=el.offsetLeft;me.instance.dragStartTop=el.offsetTop}}if(to!=null){if(me.instance.endDrag==null){dl.slideActions.moveComplete=null;dl.slideActions.move(el,el.parentNode,{from:el.offsetLeft,to:me.instance.dragStartLeft,force:force})}else{me.instance.endDrag({from:{x:me.instance.dragStartLeft,y:me.instance.dragStartTop},to:{x:el.offsetLeft,y:el.offsetTop}})}}me.cancelDrag()}this.drag=function(evt){var newTop=(parseInt(me.instance.dragStartTop)+evt.clientY-me.instance.y);var newLeft=(parseInt(me.instance.dragStartLeft)+evt.clientX-me.instance.x);var o={from:{x:me.instance.dragStartLeft,y:me.instance.dragStartTop},to:{x:newLeft,y:newTop}};var continueDragging=true;if(me.instance.drag!=null){continueDragging=me.instance.drag(o)}if(continueDragging==false){return}if(me.instance.fixedTop!=true){el.style.top=o.to.y+"px"}if(me.instance.fixedLeft!=true){el.style.left=(o.to.x)+"px"}wflib.DHTMLLib.preventDefault(evt)}}function _getParentByClass(el,className){var elParent=el;for(var i=0;i<10;i++){if(elParent==null){break}if(bHasClass(elParent,className)){return elParent}elParent=elParent.parentNode}return null}function _getChildByClass(el,className){try{for(var i=0;i<el.childNodes.length;i++){var node=el.childNodes[i];if(node.nodeType!=3){if(bHasClass(node,className)){return node}var match=_getChildByClass(node,className);if(match!=null){return match}}}}catch(e){return null}}function _getChildByType(el,wftypeValue){try{for(var i=0;i<el.childNodes.length;i++){var node=el.childNodes[i];if(node.nodeType!=3){if(node.getAttribute("wftype")==wftypeValue||node.getAttribute("type")==wftypeValue){return node}var match=_getChildByType(node,wftypeValue);if(match!=null){return match}}}}catch(e){return null}}function _getParentByType(el,wftypeValue){try{var parent=el;for(var i=0;i<15;i++){if(parent.getAttribute("wftype")==wftypeValue||parent.getAttribute("type")==wftypeValue||parent.getAttribute("widgetType")==wftypeValue){break}parent=parent.parentNode}if(i==15){return null}return parent}catch(e){return null}}function getMousePos(e){var posx=0;var posy=0;if(e.pageX||e.pageY){posx=e.pageX;posy=e.pageY}else{if(e.clientX||e.clientY){posx=e.clientX+document.body.scrollLeft+document.documentElement.scrollLeft;posy=e.clientY+document.body.scrollTop+document.documentElement.scrollTop}}return{x:posx,y:posy}}function _transition(el,shrink){var thisTransition=this;this.e=el;var elementHeight=parseInt(thisTransition.e.offsetHeight);var elementWidth=parseInt(thisTransition.e.offsetWidth);var elementFilter=el.style.filter;var elementOpacity=el.style.opacity;var _bShrink=(shrink==null)?true:shrink;var reduceHeight=Math.round(elementHeight/10);var reduceWidth=Math.round(elementWidth/10);addClass(thisTransition.e,"shrinkable");var opacity=100;var intervalId;this.onHideComplete=null;this.onStartAppear=null;this.hide=function(){opacity=100;intervalId=setInterval(_shrink,40)};this.show=function(){opacity=1;intervalId=setInterval(_appear,40)};function _appear(){thisTransition.e.style.filter="alpha(opacity="+opacity+")";try{thisTransition.e.style.opacity=(opacity/100)}catch(e){}if(opacity==1){try{thisTransition.onStartAppear()}catch(e){}}opacity+=8;if(opacity>=100){removeClass(thisTransition.e,"shrinkable");try{thisTransition.e.style.opacity=elementOpacity}catch(e){}thisTransition.e.style.filter=elementFilter;clearInterval(intervalId);try{thisTransition.onHideComplete()}catch(e){}}}function _shrink(){elementHeight-=reduceHeight;elementWidth-=reduceWidth;if(thisTransition.e!=null){try{if(_bShrink==true){thisTransition.e.style.height=elementHeight+"px"}}catch(e){}try{thisTransition.e.style.filter="alpha(opacity="+opacity+")"}catch(e){}try{thisTransition.e.style.opacity=(opacity/100)}catch(e){}opacity-=8}if(opacity<=0){removeClass(thisTransition.e,"shrinkable");thisTransition.e.style.filter=elementFilter;try{thisTransition.e.style.opacity=elementOpacity}catch(e){}clearInterval(intervalId);try{thisTransition.onHideComplete()}catch(e){}}}}function _slideActions(){var me=this;this.moveComplete;var moving=false;this.move=function(el,elContainer,position,v){if(moving){return}moving=true;var offset,pos=position.from,speed=0.4,distance,intervalId,reverse=false;if(elContainer.offsetWidth<(position.to+el.offsetWidth)&&position.force!=true){position.to=(elContainer.offsetWidth-el.offsetWidth)}distance=(position.to-position.from);if(position.from>position.to){distance=(position.from-position.to);reverse=true}var travelled=distance;offset=distance*speed;intervalId=setInterval(_move,20);function _move(){if(reverse){pos-=offset}else{pos+=offset}travelled-=offset;offset=travelled*speed;if(v==true){el.style.top=pos+"px"}else{el.style.left=pos+"px"}if(parseInt(travelled)<=1){clearInterval(intervalId);moving=false;el.style.left=position.to;try{me.moveComplete()}catch(e){}}}}}function getWindowPane(){return'<div class="subwindow" type="windowpane" ><span class="header" type="wp_header">wp_header_title</span><div id="wp_content_id" type="wp_content" class="windowpanecontent"></div></div>'}function setWaitDisplay(objWaitDisplay){with(objWaitDisplay){id=uniqueID;style.cssText="BORDER-RIGHT: 1px outset;PADDING-RIGHT: 30px;    BORDER-TOP: 1px outset;    PADDING-LEFT: 30px;    FONT-SIZE: 16pt;    PADDING-BOTTOM: 30px;    BORDER-LEFT: 1px outset;    CURSOR: wait;    COLOR: black;    PADDING-TOP: 30px;    BORDER-BOTTOM: 1px outset;    POSITION: absolute;    BACKGROUND-COLOR: #7BA2E7;    TEXT-ALIGN: center";style.display="none";noWrap=true;style.setExpression("top","(document.body.clientHeight/3) - "+id+".offsetHeight");style.setExpression("left","(document.body.clientWidth/2) - ("+id+".offsetWidth/2)");innerHTML="<img SRC='"+top.helperLib.wsfMapPath("/widgets/statusanimation.gif")+"' ALIGN='absmiddle' HEIGHT='36' WIDTH='36' STYLE='FILTER: invert'> Loading... Please wait."}}function _toggleClass(el,sClass){if(bHasClass(el,sClass)){removeClass(el,sClass)}else{addClass(el,sClass)}}function replaceClass(elItem,oldClass,newClass){if(elItem==null){return}var r=new RegExp("\\b"+oldClass+"\\b","gi");var exClass=elItem.className;elItem.className=exClass.replace(r,newClass)}function addClass(elItem,sNewClass){try{if(elItem==null){return}if(!bHasClass(elItem,sNewClass)){elItem.className+=" "+sNewClass}}catch(e){}}function removeClass(elItem,sOldClass){try{if(elItem==null){return}var oldClasses=sOldClass.split(" ");var newClass=elItem.className;for(var i=0;i<oldClasses.length;i++){var r=new RegExp("\\b"+oldClasses[i]+"\\b","gi");newClass=newClass.replace(r,"")}elItem.className=newClass}catch(e){}}function bHasClass(el,sClass){if(el==null){return}var c=el.className;var r=new RegExp("\\b"+sClass+"\\b","gi");if(r.test(c)){return true}else{return false}}function removeStyleSheet(sStyleSheetLocation){try{var w=window;if(arguments.length>1){w=arguments[1]}var objLinks=w.document.getElementsByTagName("LINK");for(var i=0;i<objLinks.length;i++){if(objLinks[i].href.indexOf(sStyleSheetLocation)>=0){w.document.removeChild(objLinks[i]);break}}}catch(e){}}var crossDomainCalls=new Array();function _crossDomainCall(windowElement,scriptSource){s=_addScript(windowElement,scriptSource);crossDomainCalls[crossDomainCalls.length]={el:s,on:new Date().valueOf()};setTimeout(_clearCrossDomainCalls,5000)}function _clearCrossDomainCalls(){for(var i=crossDomainCalls.length-1;i>=0;i--){if((new Date().valueOf()-crossDomainCalls[i].on)>5000){crossDomainCalls[i].el.parentNode.removeChild(crossDomainCalls[i].el);crossDomainCalls.splice(i,1)}}}function _addScript(windowElement,scriptSource){try{var elDocument=windowElement.document.getElementsByTagName("head")[0]||windowElement.documentElement;var scriptTag=windowElement.document.createElement("script");scriptTag.type="text/javascript";scriptTag.async="async";scriptTag.src=unescape(scriptSource);elDocument.appendChild(scriptTag);return scriptTag}catch(e){_writeScript(scriptSource)}}function _writeScript(scriptSource){try{var elDocument=windowElement.document.getElementsByTagName("head")[0]||windowElement.documentElement;var scriptTag=windowElement.document.createElement("script");return _addScript(scriptSource)}catch(e){}var newScript=unescape("%3Cscript type='text/javascript' src='"+scriptSource+"'>%3C/script>");document.write(newScript)}function AddStyleSheet(styleSheetLocation){var w=window;if(arguments.length>1){w=arguments[1]}if(w.document.createStyleSheet){w.document.createStyleSheet(styleSheetLocation)}else{var newSS=w.document.createElement("link");newSS.rel="stylesheet";newSS.type="text/css";newSS.href=styleSheetLocation;newSS=w.document.getElementsByTagName("head")[0].appendChild(newSS)}}function getWindowPos(element,stopatTagName,stopAtTagType,includeMargins){var rect=new Array();rect[0]=0;rect[1]=0;if(element==null){return rect}rect[2]=element.offsetWidth;rect[3]=element.offsetHeight;if(stopatTagName==null){stopatTagName="body"}if(stopAtTagType!=null){var stop=element.getAttribute("wftype");if(stop!=null&&stop.toLowerCase()==stopAtTagType.toLowerCase()){stopAtTagType=true}}if(element.tagName.toLowerCase()!=stopatTagName.toLowerCase()&&stopAtTagType!=true){var parentRect=[0,0,0,0];if(element.offsetParent!=null){var parentRect=getWindowPos(element.offsetParent,stopatTagName,stopAtTagType,includeMargins)}var topMargin=0,leftMargin=0;if(includeMargins==true){topMargin=getNumberStyleProp(element,"marginTop")+getNumberStyleProp(element,"paddingTop");leftMargin=getNumberStyleProp(element,"marginLeft")+getNumberStyleProp(element,"paddingLeft")}rect[0]=element.offsetLeft+leftMargin+parentRect[0];rect[1]=element.offsetTop+topMargin+parentRect[1];rect[1]-=element.scrollTop;if((navigator.userAgent.indexOf("MSIE")<0)){}}return rect}function getNumberStyleProp(el,prop){var n=getStyleProp(el,prop)||0;n=n.toString().replace("px","");if(isNaN(n)){n=0}return parseInt(n)}function captureMouse(oSource,objWin){var objSource=oSource;var win=objWin;objSource.onmousemove=moveDragDiv;var m_offsetX=win.event.offsetX;var m_offsetY=win.event.offsetY;var m_bBeginMove=false;win.event.cancelBubble=true;win.event.returnValue=false;function moveDragDiv(){try{if(!m_bBeginMove){m_bBeginMove=true;m_offsetX=win.event.offsetX;m_offsetY=win.event.offsetY;objSource.setCapture();objSource.onmouseup=releaseMouse;return}if(win.event.button!=1){objSource.releaseCapture();return}objSource.style.left=win.event.clientX-m_offsetX;objSource.style.top=win.event.clientY-m_offsetY;win.event.cancelBubble=true;win.event.returnValue=false}catch(e){alert("dhtmllib.moveDragDiv:"+e.message)}}function releaseMouse(){objSource.onmousemove=null;objSource.onmouseup=null;objSource.releaseCapture();objSource=null;win=null}}function _getEvent(window,calleeArguments){var evt;try{evt=window.event}catch(e){}if(!evt){try{for(var i=0;i<10;i++){evt=calleeArguments[0];if(evt&&evt.constructor.toString().indexOf("Event]")>0){break}calleeArguments=calleeArguments.callee.caller.arguments}}catch(e){}}return evt}function _getDialog(){var obj={};if(topWindow.dialogStack!=null){obj=topWindow.dialogStack[topWindow.dialogStack.length-1];obj.arguments=obj.dialogArguments}else{if(topWindow.dialogArguments){obj=top;obj.arguments=topWindow.dialogArguments}}return obj}function _setFocusToOpenedDialog(index){try{if(topWindow.dialogStack.length-1!=index){return}topWindow.dialogStack[topWindow.dialogStack.length-1].coverframeClick()}catch(e){}}function _hideCover(){var coverFrame=topWindow.dialogCover[topWindow.dialogCover.length-1];setTimeout(function(){coverFrame.parentNode.removeChild(coverFrame)},200);topWindow.dialogCover.splice(topWindow.dialogCover.length-1,1)}function _createCover(windowRef,allowtransparency,blankPageUrl){if(blankPageUrl==null){blankPageUrl=wflib.helperLib.wsfMapPath("/mc/blank.htm")}var coverFrame=windowRef.document.createElement("iframe");var ml=parseInt(getStyleProp(windowRef.document.body,"marginLeft"));var mr=parseInt(getStyleProp(windowRef.document.body,"marginRight"));var sh=windowRef.document.body.scrollHeight;var sw=windowRef.document.body.scrollWidth;var w=windowRef.document.body.clientWidth;w+=sw;if(ml>0||mr>0){w+=ml;w+=mr}coverFrame.style.height="100%";coverFrame.style.width=w+"px";coverFrame.src=blankPageUrl;coverFrame.frameBorder="0";coverFrame.className="coverFrame "+(allowtransparency||"");coverFrame.allowTransparency=true;if(topWindow.dialogStack!=null){eval("var f = function () { _setFocusToOpenedDialog("+topWindow.dialogStack.length+")}");wflib.helperLib.attachEvents(windowRef,coverFrame,"onload",function(e){coverFrame.contentWindow.document.body.style.backgroundColor="transparent";coverFrame.contentWindow.document.body.style.backgroundImage="url("+wflib.helperLib.wsfMapPath("/widgets/assets/spacer.gif")+")";wflib.helperLib.attachEvents(windowRef,coverFrame.contentWindow.document,"click",f)})}windowRef.document.body.appendChild(coverFrame);topWindow.dialogCover[topWindow.dialogCover.length]=coverFrame;var h=coverFrame.offsetHeight;coverFrame.style.height=h+"px";coverFrame.style.zIndex=200+topWindow.dialogCover.length;return coverFrame}function _clearDialog(){if(topWindow.dialogStack){var dialog=topWindow.dialogStack[topWindow.dialogStack.length-1];dialog.callBackRef=null;dialog.callBackArguments=null;dialog.returnValue=null;dialog.outerContainer.parentNode.removeChild(dialog.outerContainer);if(dialog.coverCreated==true){_hideCover()}dialog=null;topWindow.dialogStack.splice(topWindow.dialogStack.length-1,1);if(topWindow.dialogStack.length==0){topWindow.dialogStack=null}}}function _dialogUnload(evt){if(topWindow.dialogStack){var dialog=topWindow.dialogStack[topWindow.dialogStack.length-1];try{if(dialog.callBackRef){dialog.callBackRef(dialog.returnValue,dialog.callBackArguments)}}catch(e){}_clearDialog()}}function _getScreenCenterPos(windowref,width,height){var wd=_getWindowDimensions(windowref);return{x:wd.scrolledX+(wd.width-width)/2,y:wd.scrolledY+(wd.height-height)/2}}function _getDocumentWidth(win){var returnValue;if(win.innerWidth){returnValue=win.innerWidth}else{if(win.document.documentElement&&win.document.documentElement.clientWidth){returnValue=win.document.documentElement.clientWidth}else{if(win.document.body){returnValue=win.document.body.clientWidth}}}try{if(win.document.body.clientWidth<returnValue){returnValue=win.document.body.clientWidth}}catch(e){}return returnValue}function _getDocumentHeight(win){var theHeight;if(win.innerHeight){theHeight=win.innerHeight}else{if(win.document.documentElement&&win.document.documentElement.clientHeight){theHeight=win.document.documentElement.clientHeight}else{if(win.document.body){theHeight=win.document.body.clientHeight}}}return theHeight}function _getWindowDimensions(windowref){var scrolledX,scrolledY;if(windowref.self.pageYOffset){scrolledX=windowref.self.pageXOffset;scrolledY=windowref.self.pageYOffset}else{if(windowref.document.documentElement&&document.documentElement.scrollTop){scrolledX=windowref.document.documentElement.scrollLeft;scrolledY=windowref.document.documentElement.scrollTop}else{if(document.body){scrolledX=windowref.document.body.scrollLeft;scrolledY=windowref.document.body.scrollTop}}}var h,w;if(self.innerHeight){width=windowref.innerWidth;height=windowref.innerHeight}else{if(windowref.document.documentElement&&windowref.document.documentElement.clientHeight){width=windowref.document.documentElement.clientWidth;height=windowref.document.documentElement.clientHeight}else{if(document.body){width=windowref.document.body.clientWidth;height=windowref.document.body.clientHeight}}}return{height:height,width:width,scrolledX:scrolledX,scrolledY:scrolledY}}function _showCustomDialog(windowRef,dialogArguments,createNewCover,allowtransparency,shadow,x,y,blankPageUrl){if(windowRef==null){windowRef=topWindow}if(topWindow.dialogStack==null){topWindow.dialogStack=new Array()}if(createNewCover!=false){_createCover(windowRef,allowtransparency,blankPageUrl)}var dialog={};dialog.coverCreated=(createNewCover!=false);dialog.close=_dialogUnload;dialog.outerContainer=windowRef.document.createElement("div");windowRef.document.body.appendChild(dialog.outerContainer);dialog.outerContainer.style.display="block";dialog.outerContainer.style.cssText=dialogArguments;dialog.outerContainer.style.zIndex=200+topWindow.dialogCover.length;dialog.outerContainer.style.position="absolute";var centerPosition=_getScreenCenterPos(windowRef,dialog.outerContainer.offsetWidth,dialog.outerContainer.offsetHeight);if(x!=null){centerPosition.x=x}if(y!=null){centerPosition.y=y}dialog.outerContainer.style.top=centerPosition.y+"px";dialog.outerContainer.style.left=centerPosition.x+"px";dialog.container=dialog.outerContainer.appendChild(windowRef.document.createElement("div"));dialog.container.setAttribute("wftype","dlg_container");if(shadow==true){}if(dialog.coverCreated){dialog.coverFrame=topWindow.dialogCover[topWindow.dialogCover.length-1];topWindow.dialogCover[topWindow.dialogCover.length-1].style.display="block"}dialog.returnValue=null;dialog.index=topWindow.dialogStack.length;topWindow.dialogStack[topWindow.dialogStack.length]=dialog;return dialog}function _changeToButon(divToChange,buttonType,w){try{var parentDiv=divToChange.parentNode.insertBefore(w.document.createElement("div"),divToChange);parentDiv.className="buttoncontainer";parentDiv.innerHTML="<div class='button "+buttonType+"'></div>";parentDiv.firstChild.appendChild(divToChange);rightDiv=parentDiv.firstChild.appendChild(w.document.createElement("div"));addClass(rightDiv,"right");addClass(divToChange,"content")}catch(e){}}function _refreshShadow(o){try{t=me.getParentByType(o,"shadow");t.rows[0].cells[0].childNodes[0].childNodes[1].childNodes[0].style.height=(o.offsetHeight-12)+"px"}catch(e){}}function _applyShadow(o,bgColor,className){if(className==null){className=""}var shadowHtml='<table wftype="shadow" cellpadding="0" cellspacing="0" class="shadow '+className+'"><tr><td><div style="position:relative"><div class="topleft"><div class="topright"><div class="whiteplaceholder" ></div></div></div><div style="padding:0px 7px;"><div class="left-tile"><div class="right-tile"></div></div></div><div class="bottom-left"><div class="bottom-right"><div class="bottom-tile"></div></div></div></div></td></tr></table>';shadowHtml=shadowHtml.replace(/#bgcolor#/g,bgColor);o.insertAdjacentHTML("beforeBegin",shadowHtml);var t=o.previousSibling;var zIndex=getStyleProp(o,"zIndex");if(!isNaN(zIndex)){t.rows[0].cells[0].childNodes[0].childNodes[1].childNodes[0].style.zIndex=parseInt(zIndex)-1}if(zIndex==0){o.style.position="relative";o.style.zIndex=1}var olderOffsetHeight=o.offsetHeight;setTimeout(_setHeight,50);t.rows[0].cells[0].childNodes[0].childNodes[1].appendChild(o);var loopCounter=1;_resize();return t;function _setHeight(){try{if(olderOffsetHeight==o.offsetHeight){if(loopCounter++==600){return}setTimeout(_setHeight,50);return}o.onresize=_resize;_resize()}catch(e){}}function _resize(){try{t.rows[0].cells[0].childNodes[0].childNodes[1].childNodes[0].style.height=(o.offsetHeight-12)+"px"}catch(e){}}}function _roundIt(o,w,bgcolor,onlyTop,onlyBottom,outerOrInner){if(!bgcolor){bgcolor="#F6F5F5"}if(typeof(o)=="string"){o=w.document.getElementById(o)}if(!o){return}var borderColor='style="border-color:'+bgcolor+';"';offsetWidth=o.offsetWidth;if(onlyBottom!=true){var topCorners=w.document.createElement("b");topCorners.innerHTML='<b class="c1" '+borderColor+'></b><b class="c2" '+borderColor+' ></b><b class="c3" '+borderColor+'></b><b class="c4" '+borderColor+"></b>";topCorners.className="corners tc";topCorners.style.marginRight="-"+getStyleProp(o,"paddingRight");topCorners.style.marginBottom=(parseInt(getStyleProp(o,"paddingTop"))-4)+"px";topCorners.style.marginLeft="-"+getStyleProp(o,"paddingLeft");topCorners.style.position="relative";if(outerOrInner=="outer"){topCorners.style.zIndex=2}else{topCorners.style.zIndex=1}o.insertBefore(topCorners,o.childNodes[0]);topCorners.style.width=offsetWidth}if(onlyTop!=true){var bottomCorners=w.document.createElement("b");bottomCorners.innerHTML='<b class="c4" '+borderColor+'></b><b class="c3" '+borderColor+'></b><b class="c2" '+borderColor+'></b><b class="c1" '+borderColor+"></b>";bottomCorners.className="corners bc";bottomCorners.style.marginRight="-"+getStyleProp(o,"paddingRight");bottomCorners.style.marginTop=(parseInt(getStyleProp(o,"paddingBottom"))-4)+"px";bottomCorners.style.marginLeft="-"+getStyleProp(o,"paddingLeft");bottomCorners.style.position="relative";if(outerOrInner=="outer"){bottomCorners.style.zIndex=2}else{bottomCorners.style.zIndex=1}o.appendChild(bottomCorners);bottomCorners.style.width=offsetWidth}o.style.display="inline-block";o.style.paddingTop="0px";o.style.paddingBottom="0px"}this.browser={init:function(){this.name=this.searchString(this.dataBrowser)||"An unknown browser";this.version=this.searchVersion(navigator.userAgent)||this.searchVersion(navigator.appVersion)||"an unknown version";this.OS=this.searchString(this.dataOS)||"an unknown OS"},searchString:function(data){for(var i=0;i<data.length;i++){var dataString=data[i].string;var dataProp=data[i].prop;this.versionSearchString=data[i].versionSearch||data[i].identity;if(dataString){if(dataString.indexOf(data[i].subString)!=-1){return data[i].identity}}else{if(dataProp){return data[i].identity}}}},searchVersion:function(dataString){var index=dataString.indexOf(this.versionSearchString);if(index==-1){return}return parseFloat(dataString.substring(index+this.versionSearchString.length+1))},dataBrowser:[{string:navigator.userAgent,subString:"Chrome",identity:"Chrome"},{string:navigator.userAgent,subString:"OmniWeb",versionSearch:"OmniWeb/",identity:"OmniWeb"},{string:navigator.vendor,subString:"Apple",identity:"Safari",versionSearch:"Version"},{prop:window.opera,identity:"Opera",versionSearch:"Version"},{string:navigator.vendor,subString:"iCab",identity:"iCab"},{string:navigator.vendor,subString:"KDE",identity:"Konqueror"},{string:navigator.userAgent,subString:"Firefox",identity:"Firefox"},{string:navigator.vendor,subString:"Camino",identity:"Camino"},{string:navigator.userAgent,subString:"Netscape",identity:"Netscape"},{string:navigator.userAgent,subString:"rv:11",identity:"Explorer",versionSearch:"MSIE"},{string:navigator.userAgent,subString:"MSIE",identity:"Explorer",versionSearch:"MSIE"},{string:navigator.userAgent,subString:"Gecko",identity:"Mozilla",versionSearch:"rv"},{string:navigator.userAgent,subString:"Mozilla",identity:"Netscape",versionSearch:"Mozilla"}],dataOS:[{string:navigator.platform,subString:"Win",identity:"Windows"},{string:navigator.platform,subString:"Mac",identity:"Mac"},{string:navigator.userAgent,subString:"iPhone",identity:"iPhone/iPod"},{string:navigator.userAgent,subString:"Android",identity:"Android"},{string:navigator.userAgent,subString:"iPad",identity:"iPad"},{string:navigator.platform,subString:"Linux",identity:"Linux"}]};me.browser.init();function _getPropName(prop){var alternatePropNames={Chrome:{"box-sizing":"-webkit-box-sizing"},Safari:{"box-sizing":"-webkit-box-sizing"},Mozilla:{"box-sizing":"-moz-box-sizing"}};var returnValue;try{returnValue=alternatePropNames[me.browser.name][prop]}catch(e){}if(returnValue==null){returnValue=prop}return returnValue}function getStyleProp(x,prop){prop=_getPropName(prop);if(x.currentStyle){return(x.currentStyle[prop])}if(document.defaultView.getComputedStyle){return(document.defaultView.getComputedStyle(x,"")[prop])}return(null)}function toggleDashBoards(objUnKnown){function outQuint(iTimeElapsed,iActualHeight,iTickerDuration){iTimeElapsed=iTimeElapsed/iTickerDuration-1;return Math.round(iActualHeight*(iTimeElapsed*iTimeElapsed*iTimeElapsed*iTimeElapsed*iTimeElapsed+1)+(0-iActualHeight))}function smoothOpen(){if(parseInt(pane.body.ScrollPosition)>=0){clearInterval(vInterVal);return}if(timeElapsed==16){if(pane.body.actualHeight!=pane.body.offsetHeight){pane.body.actualHeight=pane.body.offsetHeight}}timeElapsed+=16;var iNewTop=outQuint(timeElapsed,pane.body.actualHeight,tickerDuration);pane.body.ScrollPosition=iNewTop;pane.body.style.top=iNewTop+"px";pane.element.style.height=(pane.element.closedHeight+(pane.body.actualHeight+iNewTop))+"px"}function smoothClose(){try{if(pane.body.ScrollPosition<(0-pane.body.actualHeight)){clearInterval(vInterVal);pane.body.style.display="none";pane.element.style.height=(pane.element.closedHeight)+"px";return}timeElapsed+=16;var iNewTop=outQuint(tickerDuration-timeElapsed,pane.body.actualHeight,tickerDuration);pane.body.ScrollPosition=iNewTop;pane.body.style.top=iNewTop+"px";var iParentHeight=pane.element.closedHeight+(pane.body.actualHeight+iNewTop);if(iParentHeight<0){iParentHeight=pane.element.closedHeight}pane.element.style.height=iParentHeight+"px"}catch(e){}}var timeElapsed=0,tickerDuration=200;var pane={};pane.titleElement=objUnKnown;pane.toggleImage=top.XMLLib.getNodeFirstChild(pane.titleElement);pane.element=pane.titleElement.parentNode;pane.body=top.XMLLib.getNodeNextSibling(pane.titleElement);var vInterVal;if(bHasClass(pane.toggleImage,"closed")){pane.element.style.overflowY="hidden";pane.element.style.overflow="hidden";if(!pane.element.getAttribute("closedHeight")){var excludeBorder=0;var borderTopWidth=parseInt(getStyleProp(pane.element,"borderTopWidth"));if(!isNaN(borderTopWidth)){excludeBorder+=borderTopWidth}var borderBottomWidth=parseInt(getStyleProp(pane.element,"borderBottomWidth"));if(!isNaN(borderBottomWidth)){excludeBorder+=borderBottomWidth}pane.element.setAttribute("closedHeight",pane.element.offsetHeight-excludeBorder)}pane.element.style.height=pane.element.closedHeight+"px";pane.body.style.display="block";pane.body.style.visibility="hidden";pane.body.actualHeight=pane.body.offsetHeight;pane.body.ScrollPosition=(0-pane.body.maxPosition);pane.body.style.top=(0-pane.body.actualHeight)+"px";pane.body.style.visibility="visible";vInterVal=setInterval(smoothOpen,16);removeClass(pane.toggleImage,"closed");addClass(pane.toggleImage,"open")}else{removeClass(pane.toggleImage,"open");addClass(pane.toggleImage,"closed");pane.body.actualHeight=pane.body.offsetHeight;pane.body.ScrollPosition=0;pane.body.parentNode.style.overflowY="hidden";if(!pane.element.closedHeight){pane.element.closedHeight=pane.element.offsetHeight-pane.element.actualHeight}vInterVal=setInterval(smoothClose,16)}}function _fixPNG(objwindow){var arVersion=navigator.appVersion.split("MSIE");var version=parseFloat(arVersion[1]);var doc=objwindow==null?topWindow.document:objwindow.document;var shim=top.helperLib.wsfMapPath("/widgets/assets/spacer.gif");if((version>=5.5)&&(version<7)&&(doc.body.filters)){var pageImages=doc.getElementsByTagName("IMG");for(var i=0;i<pageImages.length;i++){var myImage=pageImages[i];if(myImage.src.indexOf(".png")>0){var imgID=(myImage.id)?"id='"+myImage.id+"' ":"";var imgClass=(myImage.className)?"class='"+myImage.className+"' ":"";var imgTitle=(myImage.title)?"title='"+myImage.title+"' ":"title='"+myImage.alt+"' ";var imgStyle="display:inline-block;"+myImage.style.cssText;var strNewHTML="<div "+imgID+imgClass+imgTitle+' style="width:'+myImage.width+"px; height:"+myImage.height+"px;"+imgStyle+";filter:progid:DXImageTransform.Microsoft.AlphaImageLoader(enabled='true', src='"+myImage.src+"');\"></div>";myImage.outerHTML=strNewHTML}}for(var i=doc.all.length-1,obj=null;(obj=doc.all[i]);i--){if(obj.currentStyle.backgroundImage.match(/\.png/i)!==null){var mode="scale";var bg=obj.currentStyle.backgroundImage;var src=bg.substring(5,bg.length-2);if(obj.currentStyle.backgroundRepeat=="no-repeat"){mode="crop"}obj.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+src+"', sizingMethod='"+mode+"')";obj.style.backgroundImage="url("+shim+")"}}}}}function clshelperLib(windowRefernce){var topWindow=windowRefernce;var me=this;this.lpad=_lPad;this.trim=_trim;this.ltrim=_ltrim;this.rtrim=_rtrim;this.isNullOrEmpty=_isNullOrEmpty;this.removeLineBreaks=_removeLineBreaks;this.getKeyCode=_getKeyCode;this.HTMLEncode=_HTMLEncode;this.HTMLDecode=_HTMLDecode;this.cleanForXml=_cleanForXml;this.cleanFromXml=_cleanFromXml;this.GetURL=_getURL;this.checkValidSwitch=_checkValidSwitch;this.disposeObject=_disposeObject;this.getISODate=_getISODate;this.getISODateTime=_getISODateTime;this.getDateFromISO=_getDateFromISO;this.getContextDate=_getContextDate;this.getMonthName=_getMonthName;this.getDayDiff=_getDayDiff;this.dateAdd=_dateAdd;this.getSpeedDate=_getSpeedDate;this.convertXsDurationToTime=_xsdurationToTime;this.deserialiseQueryString=_deserialiseQueryString;this.wikiToHTML=_wikiToHTML;this.buildRuleParamXml=_buildRuleParamXml;this.processSoapRequest=_processSoapRequest;this.processSoapRequestAsync=_processSoapRequestAsync;this.processServerRequest=_processServerRequest;this.processRequestAsync=_processRequestAsync;this.arrayResponseToJSON=_arrayResponseToJSON;this.cleanSoapResponse=_cleanSoapResponse;this.formatForDisplay=_formatForDisplay;this.alertChanges=_alertChanges;this.errLog=_errLog;this.errLogAsync=_errLogAsync;this.confirmLogAsync=_confirmLogAsync;this.confirmLog=_confirmLog;this.openPopup=_openPopup;this.openPopupEx=_openPopup;this.showLoading=_showLoading;this.hideLoading=_hideLoading;this.wsfMapPath=_wsfMapPath;this.mapPath=_mapPath;this.formatISODateForDisplay=_formatISODateForDisplay;this.roundNumber=_roundNumber;this.inactivityTimeout=_inactivityTimeout;this.attachEvents=_attachEvent;this.detachEvents=_detachEvent;this.soapNamespace="http://wolf.co.in/webservices";this.webServices={designer:{location:"/webservices/wf.designer/designer.asmx",soapAction:"WF.Designer"},object:{location:"/webservices/wf.object/object.asmx",soapAction:"wf.object"}};this.addReservedLocation=_addReservedLocation;var reservedLocations=",mc,widgets,webservices,wsfdesigner,design,";function _wikiToHTML(value){value=value.toString().replace(/{{break}}/g,"<br/>");value=value.toString().replace(/----/g,"<hr/>");value=value.toString().replace(/::::/g,"<span style='display:inline-block;margin-left:30px'></span>");value=value.toString().replace(/:::/g,"<span style='display:inline-block;margin-left:20px'></span>");value=value.toString().replace(/::/g,"<span style='display:inline-block;margin-left:10px'></span>");value=value.replace(/==(.[^==]*)==/g,"<h1>$1</h1>");return value}this.getGuid=function(){var guid="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(c){var r=Math.random()*16|0,v=c=="x"?r:(r&3|8);return v.toString(16)});return guid};this.getUniqueId=function(small){var dt=new Date();if(small!=true){return"wolf_"+dt.valueOf()+Math.floor((Math.random()*100))}else{return dt.getSeconds()+""+dt.getMilliseconds()+Math.floor((Math.random()*100))}};function _dateAdd(date,n,period){if(period=="d"){n=n*86400000;date=new Date(date.valueOf()+n)}if(period=="m"){date=new Date(date.getFullYear(),(date.getMonth()+1)+n,1)}return date}function _formatForDisplay(data,type){var returnValue=data.replace(/&#13;/g,"<br/>");switch(type){case"boolean":returnValue=(data==1||data=="yes")?"Yes":"No";break;case"datetime":returnValue=_formatISODateForDisplay(data);break;case"time":returnValue=_xsdurationToTime(data);break}return returnValue}function _inactivityTimeout(callback,durationInMilliSeconds){var me=this;var _actvityAt;var _intervalId;this.activity=function(){_actvityAt=new Date();if(_intervalId==null){_intervalId=setInterval(_checkDuration,me.duration)}};this.duration=durationInMilliSeconds;this.stop=function(){if(_intervalId!=null){clearInterval(_intervalId)}_intervalId=null};function _checkDuration(){var now=new Date();var _elapsedDuration=now.valueOf()-_actvityAt.valueOf();if(_elapsedDuration>=me.duration){clearInterval(_intervalId);_intervalId=null;try{callback()}catch(e){}}}}function _cleanSoapResponse(responseXml){var re=/&apos;/g;responseXml=responseXml.replace(re,"'");re=/%26/g;responseXml=responseXml.replace(re,"&");re=/%2B/g;responseXml=responseXml.replace(re,"+");responseXml=responseXml.replace(/(&amp;)(amp;)/g,"&$2");responseXml=responseXml.replace(/&(?![#\w]*;)/g,"&amp;");responseXml=responseXml.replace(/&amp;#13;/g,"\n");return responseXml}function _buildRuleParamXml(){var returnValue="<document><record>";for(var i=0;i<arguments.length;i+=2){var paramName=arguments[i];var paramValue=arguments[i+1];returnValue+="<"+paramName+">"+paramValue+"</"+paramName+">"}returnValue+="</record></document>";return returnValue}function _xsdurationToTime(xsduration){if(xsduration.indexOf("T")!=-1){if(xsduration.indexOf("H")==-1&&xsduration.indexOf("M")==-1&&xsduration.indexOf("S")==-1){arrTime=xsduration.split("T")[1].split(":");var hrs=parseInt(arrTime[0]);var ampm="AM";if(hrs>11){hrs-=12;ampm="PM"}var min=arrTime[1];if(hrs==0){hrs=12}xsduration=_lPad(hrs,2)+":"+_lPad(min,2)+" "+ampm}else{var hrs="",min="00",sec="0";var hrs=xsduration.substring(xsduration.indexOf("T")+1,xsduration.indexOf("H"));if(isNaN(hrs)){hrs="0"}if(xsduration.indexOf("M")>0){if(xsduration.indexOf("H")>0){min=xsduration.substring(xsduration.indexOf("H")+1,xsduration.indexOf("M"))}else{min=xsduration.substring(xsduration.indexOf("T")+1,xsduration.indexOf("M"))}}if(xsduration.indexOf("S")>0){sec=xsduration.substring(xsduration.indexOf("M")+1,xsduration.indexOf("S"))}xsduration=_lPad(hrs,2)+":"+_lPad(min,2)}}else{if(!isNaN(xsduration)){var hrs=Math.floor(xsduration/3600);var min=(xsduration-(hrs*3600))/60;xsduration=_lPad(hrs,2)+":"+_lPad(min,2)}}return xsduration}function _getDayDiff(arrStart,arrFinish){try{var dStart=new Date(arrStart[0],arrStart[1]-1,arrStart[2]);var dFinish=new Date(arrFinish[0],arrFinish[1]-1,arrFinish[2]);return(((((dFinish.valueOf()-dStart.valueOf())/1000)/60)/60)/24)}catch(e){}return 0}function _roundNumber(num,dec){var result=Math.round(num*Math.pow(10,dec))/Math.pow(10,dec);var addZeroes=dec;result=result.toString();if(result.toString().indexOf(".")<0){result+="."}else{addZeroes+=dec-(result.length-result.indexOf(".")-1)}for(var i=0;i<addZeroes;i++){result+="0"}return result}function _isNullOrEmpty(val){if(val==null){return true}var v=val.toString();if(_rtrim(_ltrim(v))==""){return true}return false}function _formatISODateForDisplay(date,format,showTime){if(_isNullOrEmpty(date)){return""}var arrMonthName=new Array("Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec");var dayIndex=2;var monthIndex=1;var yearIndex=0;var sTime=" ";if(typeof(date)=="string"){if(date.indexOf("T")>0){date=date.replace("T"," ")}var arrDateTime=date.split(" ");var arrDate=arrDateTime[0].split("-");date=new Date(arrDate[yearIndex],arrDate[monthIndex]-1,arrDate[dayIndex]);if(arrDateTime.length==2){sTime+=arrDateTime[1]}}if(format=="us"){return lpad((date.getMonth()+1),2)+"/"+_lPad(date.getDate(),2)+"/"+date.getFullYear()}else{if(format=="uk"){return _lPad(date.getDate(),2)+"/"+lpad((date.getMonth()+1),2)+"/"+date.getFullYear()}else{return _lPad(date.getDate(),2)+"-"+arrMonthName[date.getMonth()]+"-"+date.getFullYear()+(showTime==true?sTime:"")}}}function _lPad(sValue,length){sValue=""+sValue;if(sValue.length<length){for(var i=0;i<(length-sValue.length);i++){sValue="0"+sValue}}return sValue}function _resolveDomReference(windowRef,domReference){if(typeof(domReference)!="object"&&windowRef.document.getElementById(domReference)){domReference=windowRef.document.getElementById(domReference)}return domReference}function _attachEvent(windowRef,domReference,eventName,ptrEventHandler,useCapture){var domReference=_resolveDomReference(windowRef,domReference);if(eventName.indexOf("on")==0){eventName=eventName.substring(2)}if(domReference.addEventListener){if(useCapture==null){useCapture=false}domReference.addEventListener(eventName,ptrEventHandler,useCapture)}else{if(domReference.attachEvent){domReference.attachEvent("on"+eventName,ptrEventHandler)}}}function _detachEvent(windowRef,domReference,eventName,ptrEventHandler,useCapture){var domReference=_resolveDomReference(windowRef,domReference);if(eventName.indexOf("on")==0){eventName=eventName.substring(2)}if(domReference.addEventListener){if(useCapture==null){useCapture=false}domReference.removeEventListener(eventName,ptrEventHandler,useCapture)}else{if(domReference.attachEvent){domReference.detachEvent("on"+eventName,ptrEventHandler)}}}this.clsEventHandler=clsEventHandler;function _addReservedLocation(sLocation){reservedLocations+=sLocation+","}function _mapPath(w,url){var currentLocation=w.location.href.split("/");currentLocation[currentLocation.length-1]=url;return currentLocation.join("/")}this.hostPrefix="";function _wsfMapPath(sURL,applicationID){var contextRef;try{contextRef=top.context}catch(e){}if(sURL==null){return sURL}if(applicationID!=null){sURL=sURL.replace("$application","/mc/em/application/"+applicationID)}else{if(contextRef!=null){if(contextRef.session!=null){sURL=sURL.replace("$application","/mc/em/application/"+contextRef.session.applicationid)}}}var skinURL="/widgets/skin";if(contextRef!=null&&contextRef.session!=null&&contextRef.session.application!=null){if(contextRef.session.application.skin!=null){skinURL+="/"+contextRef.session.application.skin}}sURL=sURL.replace("$skin",skinURL);if(me.hostPrefix.length==0){var arrTempURL=topWindow.location.href.split("/");for(var i=3;i<arrTempURL.length;i++){if(arrTempURL[i].length>0&&arrTempURL[i].indexOf("http")!=0&&i<arrTempURL.length-1){if(reservedLocations.indexOf(","+arrTempURL[i].toLowerCase()+",")>=0){break}me.hostPrefix+="/"+arrTempURL[i]}}}if(sURL.indexOf(me.hostPrefix+"/")!=0){sURL=me.hostPrefix+sURL}return sURL}function _alertChanges(quickChanges){var node=quickChanges.selectSingleNode("document");node=node.firstChild;var dialogTop=topWindow.screen.availHeight;var dialogLeft=topWindow.screen.availWidth-200;while(node!=null){var sLastQueriedAt=xl.getNodeText(node,".//WFSys_lastELQueryTimeStamp");if(sLastQueriedAt.length>0){var oContext=getContext();if(oContext!=null){oContext.lastELQueryTimeStamp=sLastQueriedAt}}dialogTop=dialogTop-102;topWindow.showModelessDialog(_wsfMapPath("/widgets/code/objectupdate.htm"),node,"dialogHeight: 100px; dialogWidth: 250px; dialogTop: "+dialogTop+"px; dialogLeft: "+dialogLeft+"px; edge: raised; help: Yes; resizable: No; status: No;unadorned:yes");node=node.nextSibling}}function getContext(){var oContext=top.context;if(oContext==null&&top.wct!=null){oContext=top.wct.adam}return oContext}function loadErrLogLangLocaliser(sPath){var objXMLErrLog;objXMLErrLog=xl.objXMLDocTemplate.cloneNode(true);objXMLErrLog.async=true;objXMLErrLog.load(sPath);top.context.cache.objErrLogLangXML=objXMLErrLog;return}function _confirmLog(description){this.description=description;var sImage;var sMessage;var sLocation="<b>Confirm</b>";sMessage=this.description;var iWidth=400;var iHeight=200;if(navigator.appName=="Microsoft Internet Explorer"&&navigator.userAgent.indexOf("MSIE 6.0")>0){iHeight+=52}var iLeft=(window.screen.availWidth-iWidth)/2;var iTop=(window.screen.availHeight-iHeight)/2;return topWindow.showModalDialog(_wsfMapPath("/widgets/code/confirmlog.htm"),this,"dialogLeft:"+iLeft+"px;dialogTop:"+iTop+"px;dialogHeight:"+iHeight+"px;dialogWidth:"+iWidth+"px;unadorned:yes")}function _confirmLogAsync(callback,title,description){this.description=description;var sImage;var sMessage;var sLocation="<b>Confirm</b>";var iWidth=400;var iHeight=200;var dialog=top.DHTMLLib.showCustomDialog(top,"height:"+iHeight+"px;width:"+iWidth+"px;",null,"allowtransparency",true);dialog.dialogArguments={description:description,title:title};dialog.container.innerHTML="<iframe src='"+_wsfMapPath("/widgets/code/confirmlog.htm")+"' style='height:"+iHeight+"px;width:"+iWidth+"px;border:0px' frameborder='0' allowtransparency = 'true'></iframe>";dialog.callBackRef=_cb_confirmLog;dialog.callBackArguments=callback;function _cb_confirmLog(returnValue,args){if(args!=null){setTimeout(function(){args(returnValue)},10)}}}function _errLogAsync(callback,page,line,versionNo,description){var iWidth=400;var iHeight=200;var dialog=top.DHTMLLib.showCustomDialog(top,"height:"+iHeight+"px;width:"+iWidth+"px;",null,"allowtransparency",true);var errorObject=_getErrorObject(page,line,versionNo,description);dialog.dialogArguments=errorObject;dialog.container.innerHTML="<iframe src='"+_wsfMapPath("/widgets/code/errorlog.htm")+"' style='height:"+iHeight+"px;width:"+iWidth+"px;border:0px' frameborder='0' allowtransparency = 'true'></iframe>";dialog.callBackRef=_cb_errorLog;dialog.callBackArguments=callback}function _cb_errorLog(returnValue,args){if(args!=null){args(returnValue)}}function _errLog(page,line,versionNo,description){var errorObject=_getErrorObject(page,line,versionNo,description);if(!topWindow.showModalDialog){alert(xl.getNodeText(errorObject.description,"/err"))}else{var iWidth=400;var iHeight=200;if(navigator.appName=="Microsoft Internet Explorer"&&navigator.userAgent.indexOf("MSIE 6.0")>0){iHeight+=52}var iLeft=(window.screen.availWidth-iWidth)/2;var iTop=(window.screen.availHeight-iHeight)/2;topWindow.showModalDialog(_wsfMapPath("/widgets/code/errorlog.htm"),errorObject,"dialogTop:"+iTop+"px;dialogLeft:"+iLeft+"px;dialogHeight:"+iHeight+"px;dialogWidth:"+iWidth+"px;unadorned:yes;status:no;resizable:no;help:no;")}}function _getErrorObject(page,line,versionNo,description){var errorObject={};try{var sLangFolder=top.context.session.languageFolder;var sLangXML="";if(sLangFolder!=""&&top.context.cache.objErrLogLangXML!=null){var objXMLErrLog;objXMLErrLog=xl.objXMLDocTemplate.cloneNode(true);objXMLErrLog.async=true;if(top.context.cache.objErrLogLangXML==null){sErrLogXMLPath=_wsfMapPath("/mc/"+sLangFolder+"application/"+top.context.session.applicationid+"/ErrLog_Localiser.xml");loadErrLogLangLocaliser(sErrLogXMLPath)}objXMLErrLog=top.context.cache.objErrLogLangXML;sLangXML=objXMLErrLog.xml;if(sLangXML!=""){var sDesc="<document><record><desc>"+description+"</desc></record></document>";var objTmpXML=xl.objXMLDocTemplate.cloneNode(true);var sXML="<root><source>"+sDesc+"</source><language>"+sLangXML+"</language></root>";var re=/&apos;/g;sXML=sXML.replace(re,"'");re=/&/g;sXML=sXML.replace(re,"%26");m_objXSLForLocaliser=xl.objXSLDocTemplate.cloneNode(true);m_objXSLForLocaliser.loadXML('<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform"><xsl:output method="xml" omit-xml-declaration="yes" /><xsl:template match="/"><document><record><xsl:apply-templates select="//source/document/record" mode="localise" /></record></document></xsl:template><xsl:template match="record" mode="localise"><xsl:variable name="valDesc" select="desc" /><xsl:variable name="valSep">##</xsl:variable><xsl:choose><xsl:when test="contains($valDesc, $valSep)"><desc><xsl:call-template name="strsplit"><xsl:with-param name="string" select="$valDesc" /><xsl:with-param name="pattern">##</xsl:with-param></xsl:call-template></desc></xsl:when><xsl:otherwise><xsl:variable name="valDescNormalised" select="normalize-space($valDesc)" /><xsl:variable name="valLngDesc" select="//root/language/document/record[code=$valDescNormalised]/label" /><xsl:choose><xsl:when test="string-length($valLngDesc) > 0"><xsl:value-of select="$valLngDesc" /></xsl:when><xsl:otherwise><xsl:value-of select="$valDesc" /></xsl:otherwise></xsl:choose></xsl:otherwise></xsl:choose></xsl:template><xsl:template name="strsplit"><xsl:param name="string" /><xsl:param name="pattern" /><xsl:choose><xsl:when test="not($string)" /><xsl:when test="not($pattern)"><xsl:call-template name="strsplit-characters"><xsl:with-param name="string" select="$string" /></xsl:call-template></xsl:when><xsl:otherwise><xsl:call-template name="strsplit-pattern"><xsl:with-param name="string" select="$string" /><xsl:with-param name="pattern" select="$pattern" /></xsl:call-template></xsl:otherwise></xsl:choose></xsl:template><xsl:template name="strsplit-characters"><xsl:param name="string" /><xsl:if test="$string"><xsl:value-of select="substring($string, 1, 1)" /><xsl:call-template name="strsplit-characters"><xsl:with-param name="string" select="substring($string, 2)" /></xsl:call-template></xsl:if></xsl:template><xsl:template name="strsplit-pattern"><xsl:param name="string" /><xsl:param name="pattern" /><xsl:choose><xsl:when test="contains($string, $pattern)"><xsl:if test="not(starts-with($string, $pattern))"><xsl:variable name="valDesc" select="substring-before($string, $pattern)" /><xsl:variable name="valDescNormalised" select="normalize-space($valDesc)" /><xsl:variable name="valLngDesc" select="//root/language/document/record[code=$valDescNormalised]/label" /><xsl:choose><xsl:when test="string-length($valLngDesc) > 0"><xsl:value-of select="$valLngDesc" /></xsl:when><xsl:otherwise><xsl:value-of select="$valDesc" /></xsl:otherwise></xsl:choose></xsl:if><xsl:call-template name="strsplit-pattern"><xsl:with-param name="string" select="substring-after($string,$pattern)" /><xsl:with-param name="pattern" select="$pattern" /></xsl:call-template></xsl:when><xsl:otherwise><xsl:variable name="valDesc" select="$string" /><xsl:variable name="valDescNormalised" select="normalize-space($valDesc)" /><xsl:variable name="valLngDesc" select="//root/language/document/record[code=$valDescNormalised]/label" /><xsl:choose><xsl:when test="string-length($valLngDesc) > 0"><xsl:value-of select="$valLngDesc" /></xsl:when><xsl:otherwise><xsl:value-of select="$valDesc" /></xsl:otherwise></xsl:choose></xsl:otherwise></xsl:choose></xsl:template></xsl:stylesheet>');var sTransResp=xl.transformXML(sXML,m_objXSLForLocaliser);if(sTransResp!=null){description=xl.getNodeText(sTransResp,"//document/record")}alert(description)}}}catch(e){}var re=/##/g;description=description.replace(re,"");errorObject.page=page;errorObject.line=line;errorObject.versionNo=versionNo;errorObject.description=description;var sImage;var sMessage;var sLocation="<b>Alert</b>";sMessage=errorObject.description;if(errorObject.page==""){sImage=_wsfMapPath("/widgets/assets/erralert.gif")}else{sLocation+="Location : "+this.page;sImage=_wsfMapPath("/widgets/assets/errcritical.gif")}if(errorObject.line!=""){sLocation+=" at line "+errorObject.line}return errorObject}function _hideLoading(windowRef){if(windowRef==null){return}try{if(windowRef.loadingDialog==null){return}}catch(e){return}windowRef.activeProcesses=windowRef.activeProcesses-1;if(windowRef.activeProcesses<0){windowRef.activeProcesses=0}if(windowRef.activeProcesses==0){windowRef.loadingDialog.style.display="none"}}function _showLoading(windowRef){if(windowRef==null){return}try{if(windowRef.loadingDialog==null){windowRef.loadingDialog=windowRef.document.createElement("div");windowRef.document.body.appendChild(windowRef.loadingDialog);windowRef.loadingDialog.innerHTML="<IMG src='"+_wsfMapPath("/widgets/assets/animated_loading.gif")+"' align='absmiddle'/>&nbsp;Working on your request...";windowRef.loadingDialog.className="loadingwindow";windowRef.activeProcesses=0}windowRef.activeProcesses++;windowRef.loadingDialog.style.display="block"}catch(e){}}function makeSoapBody(requestObject,serviceName,soapAction,functionName,args,argumentsStartIndex){requestObject.setRequestHeader("Content-Type","text/xml; charset=utf-8");var soapActionPrefix=soapAction;if(!_isNullOrEmpty(soapActionPrefix)){soapActionPrefix="/"+soapActionPrefix}var requestXML='<?xml version="1.0" encoding="utf-8"?>';requestXML+='<soap:Envelope xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/">';requestXML+="<soap:Body>";requestXML+="<"+functionName+' xmlns="'+me.soapNamespace+soapActionPrefix+'">';if(typeof(args[argumentsStartIndex])=="string"){for(var i=argumentsStartIndex;i<args.length;i+=2){requestXML+="<"+args[i]+">";requestXML+=args[i+1];requestXML+="</"+args[i]+">"}}else{for(var k in args[argumentsStartIndex]){requestXML+="<"+k+">";requestXML+=args[argumentsStartIndex][k];requestXML+="</"+k+">"}}requestXML+="</"+functionName+">";requestXML+="</soap:Body>";requestXML+="</soap:Envelope>";requestXML=requestXML.replace("<record>","<record><wsf_clienttimezoneoffset>"+(new Date()).getTimezoneOffset()+"</wsf_clienttimezoneoffset>");requestObject.setRequestHeader("Content-Length",requestXML.length);requestObject.setRequestHeader("SOAPAction",me.soapNamespace+soapActionPrefix+"/"+functionName);requestXML=_cleanSoapRequest(requestXML);requestXML=requestXML.replace(/&(?!amp;|lt;|gt;)/g,"&amp;").replace(/\+/g,"%2B");return requestXML}function _arrayResponseToJSON(response){try{response=eval("response = "+response);response.record=response.record.constructor.toString().indexOf("Array")>=0?response.record:[response.record];return response.record[0]}catch(e){return response}}function _processRequestAsync(serviceName,functionName,params,method,callBackFn){var requestObject=new XMLHttpRequest();serviceName=serviceName.replace("http:",window.location.protocol);var call={url:serviceName,method:method||"GET",params:"",addParam:function(param,value){param=encodeURIComponent(param);if(typeof value=="object"){value=JSON.stringify(value)}value=encodeURIComponent(value);if(this.url.indexOf("?")<0){this.url+="?"}if(this.method.toUpperCase()=="GET"){this.url+="&"+param+"="+value}else{this.params+="&"+param+"="+value}this.url=this.url.replace("?&","?")}};for(var v in params){call.addParam(v,params[v])}requestObject.open(call.method,call.url,true);if(call.method.toUpperCase()=="POST"){requestObject.setRequestHeader("Content-type","application/x-www-form-urlencoded")}if(navigator.userAgent.indexOf("MSIE")>=0||navigator.userAgent.indexOf("rv:11")>=0){requestObject.responseType="text"}requestObject.send(call.params);requestObject.onreadystatechange=function(){if(requestObject.readyState==4&&requestObject.status==200){try{callBackFn(requestObject.responseText)}catch(e){}}}}function _processServerRequest(sWebService,sWebMethod,sNameSpace,sParamName,sParam){var sEnvelope=createEnvelope(sWebMethod,sNameSpace,sParamName,sParam);var sSoapAction=sNameSpace+"/"+sWebMethod;var result=_processSoapRequest(null,_wsfMapPath("/webservices/wf.object/utilityprocessor.asmx"),"wf.object","RequestService","sSoapEnvelope","<![CDATA["+sEnvelope+"]]>","sSoapAction",sSoapAction,"sURL",sWebService);if(result==null){return}var xmlResponse=getNodeText(result,"//RequestServiceResponse");if(xmlResponse.length==0){return}xmlResponse=xmlResponse.replace("xmlns=","replaced=");xmlResponse=xmlResponse.replace(/&amp;lt;/g,"<");xmlResponse=xmlResponse.replace(/&amp;gt;/g,">");xmlResponse=xmlResponse.replace(/&gt;/g,">");xmlResponse=xmlResponse.replace(re=/&lt;/g,"<");var sResponse=xl.getNodeXML(xmlResponse,"//"+sWebMethod+"Result/*");return sResponse;function createEnvelope(sFunctionName,sSoapAction){var OutXML="<"+sFunctionName+' xmlns="'+sSoapAction+'">';for(var i=2;i<arguments.length;i+=2){if(arguments[i].length>0){OutXML+="<"+arguments[i]+">";OutXML+=arguments[i+1];OutXML+="</"+arguments[i]+">"}}OutXML+="</"+sFunctionName+">";return OutXML}}function getXMLHttpRequest(){var XMLHttpFactories=[function(){return new XMLHttpRequest()},function(){return new ActiveXObject("MSXML2.XMLHTTP")},function(){return new ActiveXObject("MSXML3.XMLHTTP")},function(){return new ActiveXObject("Microsoft.XMLHTTP")}];var xmlHttp;var i;for(i=0;i<XMLHttpFactories.length;i++){try{xmlHttp=XMLHttpFactories[i]()}catch(e){continue}break}try{if("withCredentials" in xmlHttp){xmlHttp.withCredentials=true}}catch(e){}return xmlHttp}function _processSoapRequest(windowRef,serviceName,soapAction,functionName){me.showLoading(windowRef);var requestObject=getXMLHttpRequest();requestObject.open("POST",serviceName.replace("http:",window.location.protocol),false);var requestXML=makeSoapBody(requestObject,serviceName,soapAction,functionName,arguments,4);if(navigator.userAgent.indexOf("MSIE")>=0||navigator.userAgent.indexOf("rv:11")>=0){requestObject.responseType="msxml-document"}requestObject.send(requestXML);var result=requestObject.responseXML;var objCallBackDetails=new callbackDetails(null,requestObject,functionName,requestXML,serviceName,soapAction,windowRef);var soapResponse=processSoapResponse(result,objCallBackDetails);me.hideLoading(windowRef);return soapResponse.result}function _processSoapRequestAsync(windowRef,callBackFn,serviceName,soapAction,functionName){me.showLoading(windowRef);var requestObject=getXMLHttpRequest();requestObject.open("POST",serviceName.replace("http:",window.location.protocol),true);var requestXML=makeSoapBody(requestObject,serviceName,soapAction,functionName,arguments,5);requestObject.onreadystatechange=standardCallback;m_arrCallBackArray[m_arrCallBackArray.length]=new callbackDetails(callBackFn,requestObject,functionName,requestXML,serviceName,soapAction,windowRef);if(navigator.userAgent.indexOf("MSIE")>=0||navigator.userAgent.indexOf("rv:11")>=0){requestObject.responseType="msxml-document"}requestObject.send(requestXML);return m_arrCallBackArray.length-1}var m_arrCallBackArray=new Array();function callbackDetails(callBackFn,requestObject,functionName,outXML,serviceName,soapAction,windowRef){this.async=((callBackFn==null)?false:true);this.pending=true;this.fnRef=callBackFn;this.xmlObject=requestObject;this.FunctionName=functionName;this.RequestXML=outXML;this.ServiceName=serviceName;this.windowRef=windowRef;this.soapAction=soapAction;this.callTime=new Date()}var m_arrSessionStack=new Array();var m_sessionLastValidated;function pushSessionStack(){var returnValue={message:"sessionstack",result:null};for(var i=0;i<m_arrSessionStack.length;i++){objCallBackDetails=m_arrSessionStack[i];objCallBackDetails.pending=true;objCallBackDetails.xmlObject.open("POST",objCallBackDetails.ServiceName,objCallBackDetails.async);objCallBackDetails.xmlObject.setRequestHeader("Content-Type","text/xml; charset=utf-8");objCallBackDetails.xmlObject.setRequestHeader("Content-Length",objCallBackDetails.RequestXML.length);objCallBackDetails.xmlObject.setRequestHeader("SOAPAction",me.soapNamespace+objCallBackDetails.soapAction+"/"+objCallBackDetails.FunctionName);objCallBackDetails.xmlObject.onreadystatechange=standardCallback;objCallBackDetails.xmlObject.send(objCallBackDetails.RequestXML);if(objCallBackDetails.async==false){returnValue.result=_checkAndCleanSoapResponse(objCallBackDetails.xmlObject.responseXML)}objCallBackDetails.callTime=new Date();m_arrSessionStack[i]=null}m_arrSessionStack=new Array();return returnValue}function _cleanSoapRequest(value){return value.replace(/\u0085/g," ").replace(/\u0091/g,"")}function _checkAndCleanSoapResponse(Result){var sResponseXML=Result.xml.replace(/xmlns=/g,"xmlns1=");Result=xl.objXMLDocTemplate.cloneNode(true);Result.loadXML(sResponseXML);return Result}function _cb_processSoapResponse(validSession){if(validSession==true){sessionValidating=false;pushSessionStack()}}var sessionValidating=false;function processSoapResponse(result,objCallBackDetails){result=_checkAndCleanSoapResponse(result);if(result.selectSingleNode("//faultstring")!=null){var sErrMessage=xl.getNodeText(result,"//faultstring");if(sErrMessage.indexOf("ex9886120856")>=0){if(sessionValidating==true){m_arrSessionStack[m_arrSessionStack.length]=objCallBackDetails;return{message:"sessiontimeout",result:null}}try{if(objCallBackDetails.callTime.valueOf()<=m_sessionLastValidated.valueOf()&&sessionValidating==false){m_arrSessionStack[m_arrSessionStack.length]=objCallBackDetails;pushSessionStack();return{message:"sessiontimeout",result:null}}}catch(e){}m_arrSessionStack[0]=objCallBackDetails;sessionValidating=true;alert("Your Session has expired. Please login again.");top.EMLib.doLogin(null,_cb_processSoapResponse);m_sessionLastValidated=new Date();return{message:"sessiontimeout",result:null}}else{if(sErrMessage.indexOf("License Exception")>=0){me.errLogAsync(null,"License validation exception","","","<b>Your License has expired</b>. Please contact your System Administrator or Vendor for further assitance.")}else{me.errLogAsync(null,"Unhandled Exception in Web Service \nService : "+objCallBackDetails.ServiceName+" ("+objCallBackDetails.FunctionName+")","","",sErrMessage);return{message:"failure",result:null}}}}var xmldoc=xl.objXMLDocTemplate.cloneNode(true);if(result.selectSingleNode("//"+objCallBackDetails.FunctionName+"Result")!=null){var sResponse=xl.getNodeText(result,"//"+objCallBackDetails.FunctionName+"Result");var Err=xl.getNodeXML(sResponse,"err");if(Err.length>0){Err=Err.replace("<err>","").replace("</err>","");Err=Err.replace(/^\\'/g,"");Err=Err.replace(/\\'$/g,"");Err=Err.replace(/%26/g,"&");if(Err.indexOf('"')==0){Err=Err.substring(1,Err.length-1)}if(objCallBackDetails.fnRef){me.errLogAsync(null,"Handled Exception in Web Service \nService : "+objCallBackDetails.ServiceName+" ("+objCallBackDetails.FunctionName+")","","",Err)}else{me.errLogAsync(null,"Handled Exception in Web Service \nService : "+objCallBackDetails.ServiceName+" ("+objCallBackDetails.FunctionName+")","","",Err)}return{message:"failure",result:null}}else{Err=xl.getNodeXML(sResponse,"//alert").replace("<alert>","").replace("</alert>","");Err=Err.replace(/^'/g,"");Err=Err.replace(/'$/g,"");Err=Err.replace(/%26/g,"&");if(Err.length>0){if(objCallBackDetails.fnRef){setTimeout(function(){me.errLogAsync(null,"","","",Err)},200)}else{setTimeout(function(){me.errLogAsync(null,"","","",Err)},200)}}}}return{message:"success",result:result}}function standardCallback(){for(var i=0;i<m_arrCallBackArray.length;i++){var objCallBackDetails=m_arrCallBackArray[i];if(objCallBackDetails.pending==true){if(objCallBackDetails.xmlObject.readyState!=4){continue}Result=objCallBackDetails.xmlObject.responseXML;objCallBackDetails.pending=false;var processResponse={message:"failure",result:null};if(Result!=null){processResponse=processSoapResponse(Result,objCallBackDetails)}if(processResponse.message=="success"||processResponse.message=="failure"){try{objCallBackDetails.fnRef(processResponse.result,i)}catch(e){}me.hideLoading(objCallBackDetails.windowRef);objCallBackDetails.xmlObject=null;objCallBackDetails.fnRef=null;objCallBackDetails.FunctionName=null;objCallBackDetails.RequestXML=null;objCallBackDetails.windowRef=null}}}}function clsEventHandler(){var m_arrEventHandlers=new Array();this.detachEvent=detachEvent;this.attachEvent=attachEvent;this.raiseEvent=raiseEvent;this.dispose=_dispose;function _dispose(){for(var sMethod in m_arrEventHandlers){for(var sPtr in m_arrEventHandlers[sMethod]){try{m_arrEventHandlers[sMethod][sPtr]=null}catch(e){}}try{m_arrEventHandlers[sMethod]=null}catch(e){}}}function getptrString(ptrEventHandler){return"wsf_ptr"+ptrEventHandler.toString().replace(/[\s .&"'(){}\[\]]/g,"").substring(0,30)}function detachEvent(sEventName,ptrEventHandler){try{var sEventName=sEventName.toLowerCase();var pointerName=getptrString(ptrEventHandler);if(m_arrEventHandlers[sEventName]!=null&&m_arrEventHandlers[sEventName][pointerName]){m_arrEventHandlers[sEventName][pointerName]=null}}catch(e){}}function attachEvent(sEventName,ptrEventHandler){var sEventName=sEventName.toLowerCase();if(m_arrEventHandlers[sEventName]==null){m_arrEventHandlers[sEventName]=new Array()}var pointerName=getptrString(ptrEventHandler);m_arrEventHandlers[sEventName][pointerName]=ptrEventHandler}function raiseEvent(sEventName,evt){if(evt==null){evt=new Object()}evt.type=sEventName;evt.cancel=false;if(evt.srcElement!=null&&evt.rootsrcElement==null){evt.rootsrcElement=evt.srcElement}var ptrCollection=m_arrEventHandlers[sEventName.toLowerCase()];var returnValue=true;for(k in ptrCollection){if(k.indexOf("wsf_ptr")==0){try{ptrCollection[k](evt);if(evt.cancel==true){returnValue=false}}catch(e){returnValue=true}}}return returnValue}}function _openPopup(popupName,dialogArgs,arguments,windowRef,cb){if(windowRef==null){windowRef=window}objTop=windowRef;for(var i=0;i<10;i++){if(objTop.wct!=null){break}objTop=objTop.parent}var objWCT=new top.EMLib.clsWCT();if(objTop.wct!=null){objWCT.adam=objTop.wct.adam}else{if(objTop.context!=null){objWCT.adam=objTop.context}}objWCT.parentWCT=objTop.wct;objWCT.bfu=popupName;objWCT.popupArgs=arguments;var iHeight=500;if(navigator.appName=="Microsoft Internet Explorer"&&navigator.userAgent.indexOf("MSIE 6.0")>0){iHeight+=52}if(dialogArgs==""){dialogArgs="status:no;height:"+iHeight+"px;width:600px;"}else{dialogArgs=dialogArgs.toLowerCase().replace(/dialog/g,"")}objWCT.adam.libraryDef=top.libraryDef;var dialog=top.DHTMLLib.showCustomDialog(top,dialogArgs,null,"allowtransparency",true);dialog.dialogArguments=objWCT;dialog.container.innerHTML="<iframe src='"+_wsfMapPath("/widgets/runtime/htc/wct.htm")+"' style='"+dialogArgs+";border:0px' frameborder='0' allowtransparency = 'true'></iframe>";dialog.callBackRef=_cb_openPopup;dialog.callBackArguments=cb;function _cb_openPopup(returnValue,args){if(args!=null){try{args(returnValue)}catch(e){}}}}function _checkValidSwitch(sSwitch){for(var i=1;i<arguments.length;i++){if(sSwitch==arguments[i]){return sSwitch}}return -1}function _getKeyCode(sKeyCode){for(var i=1;i<arguments.length;i++){if(sKeyCode==arguments[i]){return sKeyCode}}return -1}function _getMonthName(iMonth,shortName){var arrMonth=new Array("January","February","March");var arrMonth=arrMonth.concat("April","May","June");var arrMonth=arrMonth.concat("July","August","September");var arrMonth=arrMonth.concat("October","November","December");if(shortName==true){return arrMonth[iMonth].substr(0,3)}else{return arrMonth[iMonth]}}function _getDateFromISO(isoDate){var ds=isoDate.split("T")[0].split("-");var t=isoDate.split("T")[1];if(t!=null){t=t.split(":");return new Date(Date.UTC(ds[0],ds[1]-1,ds[2],t[0],t[1]))}else{return new Date(ds[0],ds[1]-1,ds[2])}}function _getContextDate(value,ISO){var today=new Date();var year=today.getFullYear();var month=today.getMonth();var day=today.getDate();switch(value.toLowerCase()){case"tomorrow":day=today.getDate();break;case"yesterday":day=today.getDate()-1;break;case"last week":day=today.getDate()-7;break;case"next week":day=today.getDate()+7;break;case"last month":day=today.getDate()-30;break;case"next month":day=today.getDate()+30;break;case"day before":day=today.getDate()-2;break;case"day after":day=today.getDate()+2;break}value=new Date(year,month,day);if(ISO==true){value=hl.getISODate(value)}return value}function _getISODateTime(dateObj){var sMonth=lpad((dateObj.getMonth()-0+1),2);var sDate=lpad(dateObj.getDate(),2);var sHour=lpad(dateObj.getHours(),2);var sMinutes=lpad(dateObj.getMinutes(),2);return dateObj.getFullYear()+"-"+sMonth+"-"+sDate+"T"+sHour+":"+sMinutes}function _getISODate(dateObj){var sMonth=""+(dateObj.getMonth()-0+1);var sDate=""+dateObj.getDate();if(sMonth.length==1){sMonth="0"+sMonth}if(sDate.length==1){sDate="0"+sDate}var sISO=dateObj.getFullYear()+"-"+sMonth+"-"+sDate;return sISO}function _disposeObject(obj){for(var sMethod in obj){try{obj[sMethod]=null}catch(e){}}}function _deserialiseQueryString(href){if(!href){href=top.location.href}var queryString={};try{var qs=href.split("?")[1].split("&");for(var i=0;i<qs.length;i++){var param=qs[i].split("=");if(param[1]!=null&&param[1]!=""){queryString[param[0].toLowerCase()]=unescape(param[1])}}}catch(e){}return queryString}var m_errMessages="";function _getSpeedDate(){dt=new Date();return"-##-"+dt.getMinutes()+":"+dt.getSeconds()+":"+dt.getMilliseconds()+" "}function _trim(s){return(_rtrim(_ltrim(s)))}function _ltrim(s){return s.replace(/^\s*/,"")}function _rtrim(s){return s.replace(/\s*$/,"")}function _removeLineBreaks(str){try{var re=/\r/g;str=str.replace(re,"");re=/\n/g;str=str.replace(re,"");re=/\t/g;str=str.replace(re,"");return str}catch(e){}}function _getURL(sURL){var arrLocation=topWindow.location.href.split("/");var sRoot=arrLocation[0]+"/"+arrLocation[1]+"/"+arrLocation[2];if(sURL.substring(0,1)=="/"){return sRoot+sURL}}function _cleanForXml(value){return value.replace(/&(?![#\w]*;)/g,"&amp;").replace(/</g,"&lt;").replace(/>/,"&gt;")}function _cleanFromXml(value){return value.replace(/&lt;/g,"<").replace(/&gt;/,">").replace(/&amp;/,"&")}function _HTMLDecode(t){var h,d,e,i,c,r,j;h="&,\",<,>,','".split(",");e="&amp;amp;,&amp;quot;,&amp;lt;,&amp;gt;,&apos;,&amp;apos;".split(",");d=t;var re=/&amp;/g;d=d.replace(re,"&");var re=/&apos;/g;d=d.replace(re,"'");var re=/&quot;/g;d=d.replace(re,'"');var re=/&lt;/g;d=d.replace(re,"<");var re=/&gt;/g;d=d.replace(re,">");return d}function _HTMLEncode(t){var h,d,e,i,c,r,j;h='&,",<,>'.split(",");e="&amp;amp;,&amp;quot;,&amp;lt;,&amp;gt;".split(",");d="";if(t.length>0){for(i=0;i<t.length;i++){c=t.substr(i,1);r=0;for(j=0;j<h.length;j++){if(c==h[j]){d+=e[j];r=1;break}}if(r==0){d+=c}}}return d}}var evalText="var utils = {}";try{if(utils){evalText=""}}catch(e){}eval(evalText);var monthIndex={jan:"01",feb:"02",mar:"03",apr:"04",may:"05",jun:"06",jul:"07",aug:"08",sep:"09",oct:"10",nov:"11",dec:"12"};var monthLongIndex={january:"01",february:"02",march:"03",april:"04",may:"05",june:"06",july:"07",august:"08",september:"09",october:"10",november:"11",december:"12"};var yesNoIndex={y:1,yes:1,"1":1,"true":1,on:1,n:0,no:0,"0":0,"false":0,off:0};var revMonthIndex={"01":"Jan","02":"Feb","03":"Mar","04":"Apr","05":"May","06":"Jun","07":"Jul","08":"Aug","09":"Sep","10":"Oct","11":"Nov","12":"Dec"};var validationReplacement={"datetime-iso":"$1-$2-$3","datetime-ddmmyy":"$3-$2-$1","datetime-mmddyy":"$3-$1-$2","datetime-ddmm":function(a){a=a.replace(/[\t]/g,"").toLowerCase();var c=a.split(/[-/ \.]/);c=removeEmptyIndexes(c);var b=startChar+(new Date).getFullYear()+"-"+c[1]+"-"+c[0]+endChar;return b},"datetime-mmyy":"$2-$1-01","datetime-ddmmmyy":function(a){a=a.replace(/[\t]/g,"").toLowerCase();var c=a.split(/[-/ \.]/);c=removeEmptyIndexes(c);var b=startChar+c[2]+"-"+_getMonthIndex(c[1])+"-"+c[0]+endChar;return b},"datetime-mmmddyy":function(a){a=a.replace(/[\t]/g,"").toLowerCase();var c=a.split(/[-/ \.]/);c=removeEmptyIndexes(c);var b=startChar+c[2]+"-"+_getMonthIndex(c[0])+"-"+c[1]+endChar;return b},"datetime-ddmmm":function(a){a=a.replace(/[\t]/g,"").toLowerCase();var c=a.split(/[-/ \.]/);c=removeEmptyIndexes(c);var b=startChar+(new Date).getFullYear()+"-"+_getMonthIndex(c[1])+"-"+c[0]+endChar;return b},"datetime-mmmdd":function(a){a=a.replace(/[\t]/g,"").toLowerCase();var c=a.split(/[-/ \.]/);c=removeEmptyIndexes(c);var b=startChar+(new Date).getFullYear()+"-"+_getMonthIndex(c[0])+"-"+c[1]+endChar;return b},"datetime-mmmyy":function(a){a=a.replace(/[\t]/g,"").toLowerCase();var c=a.split(/[-/ \.]/);c=removeEmptyIndexes(c);var b=startChar+c[1]+"-"+_getMonthIndex(c[0])+"-01"+endChar;return b},"datetime-iso":function(a){a=a.replace(/[\t]/g,"").toLowerCase();var c=a.split(/[-/ \.]/);c=removeEmptyIndexes(c);var b=startChar+c[0]+"-"+c[1]+"-"+c[2]+endChar;return b},"text-between":function(a){return a.replace(/ /g,"")},"decimal-integer":"$1$2","decimal-integer_percent":"$1","decimal-uscomma":"$1","decimal-currency":"$1","decimal-currency_uscomma":function(a){a=a.replace(new RegExp(regExes[decimal-currency_uscomma],"g"),"$2").replace(/,/g,"")},"decimal-percent":"$1","text-normal":"$1","boolean-yesno":function(a){a=a.replace(/[\s\t]/g,"").toLowerCase();return startChar+yesNoIndex[a]+endChar},"boolean-onoff":function(a){a=a.replace(/[\s\t]/g,"").toLowerCase();return startChar+yesNoIndex[a]+endChar},"boolean-truefalse":function(a){a=a.replace(/[\s\t]/g,"").toLowerCase();return startChar+yesNoIndex[a]+endChar},"boolean-yn":function(a){a=a.replace(/[\s\t]/g,"").toLowerCase();return startChar+yesNoIndex[a]+endChar},"time-hhmma":function(a){return toSaveTimeA(a)},"time-hhmm":function(a){return toSaveTime(a)}};var dd="(0?[1-9]{1}|1[0-9]{1}|2[0-9]{1}|3[0,1]{1})";var mm="(0?[1-9]{1}|1[0-2]{1})";var mmm="(jan(uary)?|feb(ruary)?|mar(ch)?|apr(il)?|may|jun(e)?|jul(y)?|aug(ust)?|sep(tember)?|oct(ober)?|nov(ember)?|dec(ember)?)";var yy="((19|20)?\\d{2})";var dtSeperator="[-/. ]+";var regExes={"decimal-precision":"^ *([\\+\\-]?\\d*(\\.\\d{1,8})?) *$","decimal-integer":"^ *([\\+\\-])? *(\\d*)* *$","decimal-percent":"^ *([\\+\\-]?\\d*(\\.\\d{1,5})?) *% *$","decimal-integer_percent":"^ *([\\+\\-]?\\d*?) *% *$","decimal-currency":"^ *\\#symbol# *(\\d+(\\.\\d{1,5})?) *$","decimal-uscomma":"^ *([\\+\\-]?\\d*(\\.\\d{1,5})?) *$","decimal-incomma":"^ *([\\+\\-]?\\d*(\\.\\d{1,5})?) *$","decimal-currency_uscomma":"^ *([(*\\#symbol#\\s)]{1,1})* *((\\d{1,3}(,\\d{3})+)+(\\.\\d{1,5})?) *$","decimal-decimal":"^ *([\\+\\-]?\\d*(\\.\\d{1,8})?) *$","decimal-decimal2":"^ *([\\+\\-]?\\d*(\\.\\d{1,8})?) *$","decimal-decimal3":"^ *([\\+\\-]?\\d*(\\.\\d{1,8})?) *$","decimal-decimal5":"^ *([\\+\\-]?\\d*(\\.\\d{1,8})?) *$","decimal-decimal8":"^ *([\\+\\-]?\\d*(\\.\\d{1,8})?) *$","text-between":"^ *[+-]?\\d*(\\.\\d{1,5})? *[-,]? *[+-]?\\d*(\\.\\d{1,5}) *$","datetime-ddmmyy":"^ *"+dd+dtSeperator+mm+dtSeperator+yy+" *$","datetime-mmddyy":"^ *"+mm+dtSeperator+dd+dtSeperator+yy+" *$","datetime-ddmm":"^ *"+dd+dtSeperator+mm+" *$","datetime-mmmdd":"^ *"+mmm+dtSeperator+dd+" *$","datetime-mmyy":"^ *"+mm+dtSeperator+yy+" $","datetime-ddmmmyy":"^ *"+dd+dtSeperator+mmm+dtSeperator+yy+" *$","datetime-mmmddyy":"^ *"+mmm+dtSeperator+dd+dtSeperator+yy+" *$","datetime-ddmmm":"^ *"+dd+dtSeperator+mmm+" *$","datetime-mmmyy":"^ *"+mmm+dtSeperator+yy+" *$","boolean-yesno":"^ *(yes|no) *$","boolean-truefalse":"^ *(true|false) *$","boolean-onoff":"^ *(on|off) *$","boolean-yn":"^ *(y|n) *$","boolean-onezero":"^ *(1|0) *$","time-hhmma":"^ *([0]?[1-9]|1[0-2])([:.]([0-5]?[0-9]))?\\s*(a|p|am|pm) *$","text-normal":"^ *([^~]*) *$","text-email":"^ *[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])? *$","text-link":"^ *([A-Za-z]+://)?[A-Za-z0-9-_]+\\.[A-Za-z0-9-_%&;?/.=]+ *$","text-phone":"^ */\\+(?:[0-9] ?){6,14}[0-9] *$","text-alphanumeric":"^ *[a-zA-Z0-9 ]* *$","time-hhmm":"^ *([0-1]?[0-9]?|2[0-3])([:.]?)([0-5]?[0-9]) *$","datetime-iso":"^ *"+yy+dtSeperator+mm+dtSeperator+dd+" *$","longtext-long":"^ *([^~]*) *$","longtext-normal":"^ *([^~]*) *$"};function removeEmptyIndexes(b){for(var a=b.length-1;a>=0;a--){if(hl.isNullOrEmpty(b[a])){b.slice(a,1)}}return b}function _getMonthIndex(b){var a=monthIndex[hl.trim(""+b)];if(a==null){a=monthLongIndex[b]}return a}var startChar="",endChar="";if(utils.dataValidate==null){utils.dataValidate=__dataValidate;utils.changeDisplayValue=__changeDisplayValue;utils.getSaveValue=__getSaveValue}function __dataValidate(o,b,j){var a=false;var n=regExes[b.type+"-"+b.subType].replace(/#symbol#/g,"\\"+(b.symbol||""));var g=new RegExp(n,"i");if(b.type=="decimal"){o=o.replace(/,/g,"")}if(o.match(g)){a=true;if(!hl.isNullOrEmpty(b.minMaxLen)){var h=b.minMaxLen.replace(/\s/g,"").split("-");var m=h[h.length-1];h=h[0];if(o.toString().length<h||o.toString().length>m){a=false}}if(a&&validationReplacement[b.type+"-"+b.subType]!=null){o=o.replace(g,validationReplacement[b.type+"-"+b.subType])}}else{if(b.type!="text"){for(var c in regExes){if(c.indexOf(b.type+"-")==0){g=new RegExp(regExes[c].replace(/#symbol#/g,(b.symbol||"")),"i");if(o.match(g)){a=true;if(validationReplacement[c]!=null){o=o.replace(g,validationReplacement[c])}break}}}}}if(a==true&&b.type=="decimal"){if(!hl.isNullOrEmpty(o)){var p=parseFloat(o);if(p>9000000000000000||p<-9000000000000000){a=false}}}if(a==true&&b.type=="datetime"){var l=hl.getDateFromISO(o);arrVal=o.split("-");if(parseInt(arrVal[0])!=l.getFullYear()||parseInt(arrVal[1])!=(l.getMonth()+1)||parseInt(arrVal[2]!=l.getDate())){a=false}}b.value=o;return{cancel:!a,value:o}}var displayFindMasks={decimal:"^ *[+-]?((\\d*)\\.?\\d*) *",datetime:"(\\d{2,4})-(\\d{1,2})-(\\d{1,2})T?.*",text:"(.*)","boolean":"1|0",timeiso:"P(\\d{0,2})T(\\d{0,2})H?(\\d{0,2})M?(\\d{0,2})S?",time:"(\\d{0,2}):(\\d{0,2})"};var displayReplaceMasks={"datetime-iso":"$1#t$2#t$3","datetime-ddmmyy":"$3#t$2#t$1","datetime-ddmmmyy":function(a){a=a.split("T")[0].split("-");var b=a[2]+tempSeperator+revMonthIndex[hl.lpad(a[1],2)]+tempSeperator+a[0];return b},"datetime-mmmyy":function(a){a=a.split("T")[0].split("-");var b=revMonthIndex[hl.lpad(a[1],2)]+tempSeperator+a[0];return b},"datetime-ddmmm":function(a){a=a.split("T")[0].split("-");var b=a[2]+tempSeperator+revMonthIndex[hl.lpad(a[1],2)];return b},"datetime-mmddyy":function(a){a=a.split("T")[0].split("-");var b=a[1]+tempSeperator+a[2]+tempSeperator+a[0];return b},"time-hhmm":"$1:$2","timeiso-hhmm":"$2:$3","time-hhmma":function(a){var b=getFormattedTime(a);return b},"text-email":"<a target='_blank' href='mailto:$1'>$1</a>","text-link":"<a target='_blank' href='$1'>$1</a>","decimal-currency":function(a){if(hl.isNullOrEmpty(a)){return""}var b=a.split(".");var b=tempSymbol+b[0]+"."+((b[1]==null)?"00":b[1]);return b},"decimal-currency_uscomma":function(a){if(hl.isNullOrEmpty(a)){return""}var b=tempSymbol+" "+toUSD(toDecimal(a,2));return b},"decimal-uscomma":function(a){return toUSComma(toDecimal(a,2))},"decimal-incomma":function(a){return toINComma(toDecimal(a,2))},"decimal-decimal3":function(a){if(hl.isNullOrEmpty(a)){return""}var b=toDecimal(a,3);return b},"decimal-decimal5":function(a){if(hl.isNullOrEmpty(a)){return""}var b=toDecimal(a,5);return b},"decimal-decimal8":function(a){if(hl.isNullOrEmpty(a)){return""}var b=toDecimal(a,8);return b},"decimal-decimal2":function(a){if(hl.isNullOrEmpty(a)){return""}var b=toDecimal(a,2);return b},"decimal-decimal":function(a){if(hl.isNullOrEmpty(a)){return""}var b=toDecimal(a,1);return b},"decimal-percent":function(a){if(hl.isNullOrEmpty(a)){return""}var b=a.split(".");var b=b[0]+"."+((b[1]==null)?"00":b[1])+"%";return b},"decimal-integer":function(a){if(hl.isNullOrEmpty(a)){return""}var b=a.split(".");var b=b[0];return b},"decimal-integer_percent":function(a){if(hl.isNullOrEmpty(a)){return""}var b=a.split(".");var b=b[0]+"%";return b}};function getFormattedTime(c){if(c.indexOf("P")==0){c=hl.convertXsDurationToTime(c)}var c=c.split(":");var b=c[0];var g=c[1];var a=b>12?b-12:b==0?12:b;var j=g==""?0:g;var h=b>=12?"pm":"am";return hl.lpad(a,2)+":"+hl.lpad(j,2)+" "+h}var tempSymbol,tempSeperator="";function __getSaveValue(c,a){var b=a.type+"-"+a.subType;if(regExes[b]!=null){var g=new RegExp(regExes[b].replace(/#symbol#/g,(a.symbol||"")),"i");if(c.match(g)){matched=true;if(validationReplacement[b]!=null){c=c.replace(g,validationReplacement[b])}}}return c}function __changeDisplayValue(a){tempSymbol=(a.symbol=="undefined")?"":a.symbol+" ";tempSeperator=hl.isNullOrEmpty(a.seperator)?"-":a.seperator;var c=null;if(a.type=="datetime"){a.value=a.value.split(" ")[0];c=displayReplaceMasks[a.type+"-"+a.subType];if(typeof(c)!="function"){c=c.replace("#t",tempSeperator).replace("#t",tempSeperator)}}else{c=displayReplaceMasks[a.type+"-"+a.subType]}var g=displayFindMasks[a.type];var b=new RegExp(g,"i");if(c!=null){if(a.nonHTML==true&&(a.subType=="email"||a.subType=="link")){return}c=typeof(c)=="string"?c.replace("#symbol#",tempSymbol):c;a.value=a.value.replace(b,c)}return a.value}function year(b){var a=hl.getDateFromISO(b);return a.getFullYear()}function toDate(a){return hl.getDateFromISO(a)}function toISODate(a){return hl.getISODate(a)}function toSaveTimeA(a){a=a.replace(/[\t]/g,"").toLowerCase();var c=a.replace(/.*(a|p|am|pm)$/g,"$1");var h=a.replace(/ *(a|p)m?/g,"");var b=h.replace(/[:.]/g,":").split(":");var g=c.indexOf("p")>=0?(parseInt(b[0])+12):b[0];return startChar+(g==12?0:g==24?12:g)+":"+(b[1]||"0")+endChar}function toSaveTime(g){var c;if(g.indexOf(":")>0||g.indexOf(".")>0){g=g.replace(/[\t]/g,"").toLowerCase();var a=g.replace(/[:.]/g,":").split(":");var b=a[0];c=(b)+":"+(a[1]||"00")}else{if(g.length==4){c=g.substr(0,2)+":"+g.substr(2,2)}}return startChar+c+endChar}function month(b){var a=hl.getDateFromISO(b);return a.getMonth()+1}function age(c){var b=hl.getDateFromISO(c);var a=new Date();return a.getFullYear()-b.getFullYear()}function toINComma(a){a=a.toString().replace(/(\d)(?=(\d{3})($|\.))/g,"$1,");return a.toString().replace(/(\d)(?=(\d{2})+,)/g,"$1,")}function toUSComma(a){return a.toString().replace(/(\d)(?=(\d\d\d)+(?!\d))/g,"$1,")}function toUSD(c){var c=c.toString(),b=c.split(".")[0],a=(c.split(".")[1]||"")+"00";b=b.split("").reverse().join("").replace(/(\d{3}(?!$))/g,"$1,").split("").reverse().join("");return b+"."+a.slice(0,5)}function toDecimal(c,b){if(b==null){b=5}var c=c.toString(),j=c.split(".")[0],g=(c.split(".")[1]||"00").slice(0,b);var a="000000000";var h=a.substr(a.length-(b-(g.length)));return j+"."+g+h}var expressions={email:"^ *[a-zA-Z]*[\\w\\.-]*[a-zA-Z0-9]*@[a-zA-Z0-9][\\w\\.-]*[a-zA-Z0-9]\\.[a-zA-Z][a-zA-Z\\.]*[a-zA-Z] *$",pwd6:"^.*(?=.{6,})(?=.*\\d)(?=.*[a-zA-Z])(?=.*[@#$%^&+=]).*$"};function clsFormValidator(){using("helperLib");using("DHTMLLib");var j=this;var c=new hl.clsEventHandler();this.attachEvents=c.attachEvent;this.detachEvents=c.attachEvent;this.raiseEvent=c.raiseEvent;this.inValid=false;this.required=false;this.reset=function(o){var n=o.getAttribute("wfprompt");if(!hl.isNullOrEmpty(n)){a(o,n)}else{o.value=""}try{h(o,o.getAttribute("rules")||"")}catch(p){}j.raiseEvent("onreset")};function a(p,n,o){if(o==null){o=p.getAttribute("wfsubtype")||""}if(o.indexOf("pwd")==0){p.setAttribute("type","text")}p.value=n;dl.addClass(p,"prompt")}this.valid=function(){var p=true;try{var o=document.getElementsByTagName("input");if(!n()){return p}o=document.getElementsByTagName("select");if(!n()){return p}o=document.getElementsByTagName("textarea");if(!n()){return p}return p}catch(q){alert(q.Message)}function n(){for(var r=0;r<o.length;r++){if(o[r].getAttribute("valid")=="false"){j.raiseEvent("onvalid",{element:o[r]});o[r].focus();p=false;break}p=true}return p}};function h(o,z,p,x){var n=true;var u=false;z=z.split(",");for(var q=0;q<z.length;q++){switch(z[q]){case"required":if(o.value.replace(/\s/g,"").length==0){u=true}break;default:if(hl.isNullOrEmpty(o.value)){break}if(z[q].indexOf("max:")==0){var w=z[q].split(":")[1];if(parseInt(o.value.length)>parseInt(w)){n=false;o.value=o.value.substr(0,w)}break}if(!hl.isNullOrEmpty(z[q])){var v="text",y=z[q];if(y.indexOf("-")>=0){v=y.split("-")[0];y=y.split("-")[1]}if(p==null){p={}}p.type=v;p.subType=y;var r=utils.dataValidate(o.value.toString(),p);n=!r.cancel}break}if(n==false){break}}if(!u){delete j.requiredList[o.getAttribute("validatorid")]}else{j.requiredList[o.getAttribute("validatorid")]=true}if(n==true){delete j.inValidList[o.getAttribute("validatorid")]}else{j.inValidList[o.getAttribute("validatorid")]=true}m();l();return{valid:n,required:u}}this.getInputValue=function(o){var n=o.getAttribute("wfprompt");var p=o.value;if(!hl.isNullOrEmpty(n)&&p==n){p=""}return p};this.validate=function(r){var q=r.srcElement?r.srcElement:r.target;var n={element:q,col:{}};j.raiseEvent("beforevalidate",n);var p=n.col;var o=h(q,q.getAttribute("rules"),p,r);if(o.valid==true){dl.removeClass(q,"invalid")}else{dl.addClass(q,"invalid")}q.setAttribute("valid",(o.valid&&!o.required));j.raiseEvent("onvalid",{element:q});if(r.type=="change"&&p.value!=null){utils.changeDisplayValue(p);j.raiseEvent("onchange",{element:q,col:p})}};function m(){for(var n in j.inValidList){j.inValid=true;return}j.inValid=false}function l(){for(var n in j.requiredList){j.required=true;return}j.required=false}this.inValidList={};this.requiredList={};this.register=function(){var p=document.getElementsByTagName("input");n();p=document.getElementsByTagName("select");n();p=document.getElementsByTagName("textarea");n();function n(){for(var q=0;q<p.length;q++){var r=p[q];var u=r.getAttribute("rules");if(u!=null){if(u==null){alert("Dev:label attribute missing for input :"+r.id)}r.setAttribute("validatorid",hl.getUniqueId());hl.attachEvents(window,r,"onchange",j.validate);if(u.indexOf("max:")>=0){hl.attachEvents(window,r,"onkeyup",j.validate)}h(r,r.getAttribute("rules"))}if(r.getAttribute("wfprompt")!=null){new g(r,"load");hl.attachEvents(window,r,"onfocus",j.handlePrompt);hl.attachEvents(window,r,"onblur",j.handlePrompt)}}}p=document.getElementsByTagName("form");for(var o=0;o<p.length;o++){hl.attachEvents(window,p[o],"onsubmit",j.valid)}j.raiseEvent("onregistered")};function g(r,p){var q=this;this.control=r;this.eventType=p;function o(){b=true}setTimeout(n,20);function n(){b=false;var u=q.control.getAttribute("wfsubtype")||"";if(q.eventType=="focus"){if(u.indexOf("pwd")==0){q.control.setAttribute("type","password")}if(q.control.value==q.control.getAttribute("wfprompt")){q.control.value="";q.control.focus()}dl.removeClass(q.control,"prompt")}else{if(hl.isNullOrEmpty(q.control.value)){a(q.control,q.control.getAttribute("wfprompt"),u)}}setTimeout(o,20)}}var b=true;this.handlePrompt=function(n){if(!b){return}var n=dl.getEvent(window,arguments);var o=dl.getEventSrcElement(n);new g(o,n.type)}}var formValidator;try{formValidator=new clsFormValidator()}catch(e){};